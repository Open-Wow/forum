<!doctype html>
<html dir="ltr" lang="fr">
<head>
<meta charset="utf-8">
<title>Le format DBC - Open WoW</title>
<link rel="stylesheet" href="../assets/forum-b586aac9.css">
<link rel="canonical" href="34-le-format-dbc.html">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1">
<meta name="description" content="Le forum francophone d&#039;√©mulation WoW.">
<meta name="theme-color" content="#4D698E">
<link rel="shortcut icon" href="../assets/favicon-19klahq3.png">
<script src="https://www.recaptcha.net/recaptcha/api.js?hl=fr&render=explicit" async defer></script>
</head>
<body>
<div id="app" class="App">
<div id="app-navigation" class="App-navigation"></div>
<div id="drawer" class="App-drawer">
<header id="header" class="App-header">
<div id="header-navigation" class="Header-navigation"></div>
<div class="container">
<h1 class="Header-title">
<a href="https://forum.open-wow.eu" id="home-link">
<img src="../assets/logo-fje1vtuv.png" alt="Open WoW" class="Header-logo">
</a>
</h1>
<div id="header-primary" class="Header-primary"></div>
<div id="header-secondary" class="Header-secondary"></div>
</div>
</header>
</div>
<main class="App-content">
<div id="content"></div>
<div id="flarum-loading" style="display: none">
Chargement‚Ä¶
</div>
<noscript>
    <div class="Alert">
        <div class="container">
            Ce site est optimis√© pour √™tre consult√© depuis un navigateur moderne dans lequel JavaScript est activ√©.
        </div>
    </div>
</noscript>
<div id="flarum-loading-error" style="display: none">
<div class="Alert">
<div class="container">
Une erreur est survenue lors de la tentative de chargement de la version compl√®te de ce site. Veuillez purger le cache de votre navigateur et rafra√Æchir cette page pour tenter de corriger cette erreur.
</div>
</div>
</div>
<noscript id="flarum-content">
    <div class="container">
    <h2>Le format DBC</h2>

    <div>
                    <div>
                                <h3>Galathil</h3>
                <div class="Post-body">
                    <p><strong>Important :</strong> Ce tutoriel a √©t√© r√©dig√© par Nobodie pour le site wow-emu.fr. Je le recopie ici √† l'identique, Il se peut que certaines informations soient obsol√®tes √† ce jour. Bonne lecture !</p>

<h1>Le format DBC</h1>

<p>Bonsoir √† tous,</p>

<p>suite √† diff√©rents sujets et demandes en interne au sujet des DBC, j'√©cris donc ce tutoriel aujourd'hui afin de comprendre exactement ce qu'il en est. Nous verrons donc d'abord ce qu'est ce format de fichier, √† quoi il ressemble et comment le lire, puis nous verrons un petit script python capable de g√©n√©rer un fichier texte repr√©sentant les donn√©es qu'il contient. Bonne lecture √† vous üòâ</p>

<p>Ce tutoriel est bas√© sur mes travaux personnels et sur une page qui m'a beaucoup aid√© √† l'√©poque ou je n'y connaissais rien : <del><a href="http://www.pxr.dk/wowdev/wiki/index.php?title=DBC" rel=" nofollow ugc">http://www.pxr.dk/wowdev/wiki/index.php?title=DBC</a></del> Une portion de ce sujet sera copi√©e ici et traduite pour la communaut√© fran√ßaise.</p>

<h2>Partie th√©orique : les fichiers DBC</h2>
<h3>Qu'est-ce qu'un fichier DBC ?</h3>

<p>Un fichier .DBC n'est ni plus ni moins que l'√©quivalent en SQL d'une table. Ce format contient donc des informations num√©riques ou textuelles sous forme binaire. Exit donc les mod√®les 3D, les cin√©matiques ou que sais-je encore.</p>

<p>Le format DBC est utilis√© par Blizzard depuis la premi√®re version de WoW. Jusqu'√† l'extension Warlords of Draenor, celles-ci √©taient accessibles via leurs fichiers propri√©taires MoPaQs (les incontournables MPQs), et sont maintenant contenues sous une forme l√©g√®rement diff√©rentes dans leur nouveau syst√®me appel√© CASC (dont je ne parlerais pas ici).</p>

<p>Il existe une autre version "√©volu√©e" des DBC que l'on appelle les DB2. Leur format est quasiment identique, √† ceci pr√®s que toutes les donn√©es pr√©sentes dans les fichiers DB2 peuvent √™tre overwrit√©s par le serveur de jeu de fa√ßon invisible pour les joueurs. Il n'est donc pas n√©cessaire √† Blizzard d'effectuer une mise √† jour pour corriger une donn√©e dans celles-ci, par exemple. Nous ne traiterons pas les fichiers .DB2 ici, sachez simplement que le format est quasiment identique.</p>

<h3>Pourquoi ces fichiers se retrouvent-ils sur un serveur priv√© ?</h3>

<p>Si vous avez lu mon tutoriel sur le fonctionnement d'un serveur priv√© (disponible ici : <a href="http://wow-emu.fr/showthread.php?tid=167" rel=" nofollow ugc">http://wow-emu.fr/showthread.php?tid=167</a>), vous savez que le serveur a besoin d'un certain nombre d'informations en provenance du client. Les DBCs en font partie. Le principal challenge d'un serveur priv√© est de se confronter √† la masse ph√©nom√©nale de contenu disponible sur officiel. Ainsi, au lieu de cr√©er tout serveur √† partir de z√©ro, les d√©veloppeurs ont choisi d'extraire un certain nombre d'informations √† partir du client afin d'avoir une base "saine" √† partir de laquelle ils peuvent extraire un certain nombre d'informations. C'est entre autres gr√¢ce √† ces bases qu'on poss√®de les informations sur les sorts, les zones, les ma√Ætres de vol, etc etc.</p>

<p>Cependant, si vous avez bien suivi, les DBCs ne sont qu'un fichier de stockage, il n'y a aucune information sur ce qu'elles contiennent ni comment elles s'articulent les unes par rapport aux autres. Ce travail reste donc √† la charge des d√©veloppeurs de serveurs priv√©s qui doivent alors identifier chaque colonne pour en comprendre la signification et l'utilit√©.</p>

<h3>A quoi ressemble un fichier DBC ?</h3>

<p>Un fichier DBC est un fichier binaire. Si vous l'ouvrez avec Notepad++ par exemple, vous verrez un tas de caract√®res qui ne vous diront rien.</p>

<p>Si vous l'ouvrez avec un √©diteur hexad√©cimal, vous y verrez tout un tas de chiffres, qui ne vous diront rien non plus üòÄ</p>

<p>Pourtant, l'ensemble des chiffres que vous voyez devant votre √©cran fait pourtant partie de la mati√®re pure des DBCs que vous convoitez. Ces chiffres l√†, une fois bien d√©coup√©s vous permettrons d'obtenir n'importe quelle information contenue dans la DBC et vous pourrez alors en fait ce que vous voulez - en g√©n√©rer un fichier texte ou un ensemble de requ√™tes SQL par exemple.</p>

<h3>Quelle est la structure des fichiers DBC ?</h3>

<p>Pour cela, je vais me baser sur le wiki dont j'ai post√© le lien au d√©but.<br>
Voici basiquement √† quoi ressemble la structure d'une DBC :</p>

<pre><code class="language-cpp">struct dbc_header
{
uint32_t magic;
uint32_t record_count;
uint32_t field_count;
uint32_t record_size;
uint32_t string_block_size;
};

template&lt;typename record_type&gt;
struct dbc_file
{
dbc_header header;
record_type records[header.record_count];
char string_block[header.string_block_size];
};</code><script async="" crossorigin="anonymous" data-hljs-style="github-gist" integrity="sha384-eud4nQrKZMwcYak7or3J5ZPJx1x4HRe8iTTHJy1SUVrDD+fP30Bo/F8OSdQJpk8d" onload="hljsLoader.highlightBlocks(this.parentNode)" src="https://cdn.jsdelivr.net/gh/s9e/hljs-loader@1.0.18/loader.min.js"></script></pre>

<p>Cette structure est somme toute assez simple. Analysons-l√† ensemble üòâ</p>

<p>La premi√®re partie constitue ce qu'on appelle les DbcHeaders. Ils permettent d'obtenir un certain nombre d'informations sur la DBC et contient 5 variables num√©riques.</p>

<pre><code class="language-cpp">struct dbc_header
{
uint32_t magic;
uint32_t record_count;
uint32_t field_count;
uint32_t record_size;
uint32_t string_block_size;
};</code><script async="" crossorigin="anonymous" data-hljs-style="github-gist" integrity="sha384-eud4nQrKZMwcYak7or3J5ZPJx1x4HRe8iTTHJy1SUVrDD+fP30Bo/F8OSdQJpk8d" onload="hljsLoader.highlightBlocks(this.parentNode)" src="https://cdn.jsdelivr.net/gh/s9e/hljs-loader@1.0.18/loader.min.js"></script></pre>

<p>La premi√®re valeur contient, pour un fichier DBC, la valeur 1464091203. C'est ce qui permet d'identifier le fichier et de savoir qu'il s'agit d'un fichier DBC. Cette valeur est de prime abord assez barbare, mais quand on y regarde de plus pr√®s elle prend tout son sens.</p>

<p>1464091203 vaut en h√©xad√©cimal 0x57444243. Cela nous donne donc 4 octets, 0x57, 0x44, 0x42 et 0x43. Ces quatre valeurs correspondent en fait aux quatre lettres W, D, B et C. Vous pouvez le v√©rifier en allant sur ce site <a href="http://www.dolcevie.com/js/converter.html" rel=" nofollow ugc">http://www.dolcevie.com/js/converter.html</a> par exemple.</p>

<p>Quand vous voyez un fichier .wdb, c'est en fait un fichier dbc. En r√©alit√©, lorsque le fichier ne contient aucune extension, la plupart des logiciels tentent de trouver leur nom et par convention, beaucoup de formats "consomment" les trois premiers octets du fichier pour indiquer l'extension. C'est pour cette raison qu'un dezippeur renomme les fichiers en .wdb par exemple</p>

<p>Les trois valeurs suivantes sont plus simples. Nous allons prendre le cas d'une table SQL.</p>
 <ul><li>Record_count contient le nombre d'enregistrements (autrement dit, le nombre de "lignes" dans une table SQL) que contient le fichier DBC.</li>
 <li>Field_count contient le nombre de champs (autrement dit, le nombre de "colonnes" dans une table SQL) que contient le fichier DBC.</li>
 <li>Record_size contient la taille en octets d'un enregistrement (autrement dit, la taille en m√©moire d'une "ligne" dans une table SQL). Il faut savoir que dans la plupart des cas (on va dire 99% pour se laisser une l√©g√®re marge) une donn√©e dans les DBCs fait 4 octets (la taille d'un uint32). le Record_size vaut donc tr√®s souvent 4*Field_count. Cependant, dans de rares cas cela diff√®re et c'est √† √ßa que sert cette valeur.</li></ul>

<p>La derni√®re valeur est un peu diff√©rente. Nous venons de dire que chaque donn√©e dans une DBC est stock√©e sur 4 octets. Or, nous avons vu aussi que pour √©crire WDBC (une cha√Æne de caract√®res), il nous fallait √©galement 4 octets. Que faire alors si dans une DBC, Blizzard souhaite enregistrer une cha√Æne de caract√®res de plus de quatre octets ? Il y a en r√©alit√© une seconde zone de donn√©es (un second tableau, plus pr√©cis√©ment) qui contiendra absolument toutes les cha√Ænes de caract√®res. Et au lieu d'enregistrer la cha√Æne dans le premier tableau, on enregistre une variable qui contient l'offset de la cha√Æne de caract√®re dans le second tableau. Cela parait un peu complexe, mais ce n'est ni plus ni moins qu'un pointeur vers une case en m√©moire, l'avantage √©tant que ce pointeur-l√† peut √™tre stock√© dans une variable de 4 octets. Nous verrons lors de la mise en pratique que cela va nous poser quelques soucis si nous voulons identifier automatiquement le type des champs.</p>

<p>La derni√®re variable contient donc ni plus ni moins que la taille en m√©moire du tableau de cha√Ænes de caract√®res.</p>

<p>Prenons un exemple avec la DBC Achievement, dont voici les premiers octets :</p>

<pre><code>...
57444243F70C00000F0000003C000000FC8C040006000000FFFFFFFFFFFFFFFF00000000010000000B000000
...</code><script async="" crossorigin="anonymous" data-hljs-style="github-gist" integrity="sha384-eud4nQrKZMwcYak7or3J5ZPJx1x4HRe8iTTHJy1SUVrDD+fP30Bo/F8OSdQJpk8d" onload="hljsLoader.highlightBlocks(this.parentNode)" src="https://cdn.jsdelivr.net/gh/s9e/hljs-loader@1.0.18/loader.min.js"></script></pre>

<p>Et une fois d√©coup√©s en groupes de 4 octets :</p>

<pre><code>...
57 44 42 43 F7 0C 00 00 0F 00 00 00 3C 00 00 00 FC 8C 04 00 06 00 00 00 FF FF FF FF FF FF FF FF 00 00 00 00 01 00 00 00 0B 00 00 00
...</code><script async="" crossorigin="anonymous" data-hljs-style="github-gist" integrity="sha384-eud4nQrKZMwcYak7or3J5ZPJx1x4HRe8iTTHJy1SUVrDD+fP30Bo/F8OSdQJpk8d" onload="hljsLoader.highlightBlocks(this.parentNode)" src="https://cdn.jsdelivr.net/gh/s9e/hljs-loader@1.0.18/loader.min.js"></script></pre>

<p>On a donc :</p>
 <ul><li>uint32_t magic = 57 44 42 43 = "WDBC" =&gt; on est bien dans un fichier de type DBC.</li>
 <li>uint32_t record_count = F7 0C 00 00 = 3199 =&gt; il y a 3199 enregistrements</li>
 <li>uint32_t field_count = 0F 00 00 00 = 15 =&gt; il y a 15 colonnes par enregistrement</li>
 <li>uint32_t record_size = 3C 00 00 00 = 60 =&gt; chaque enregistrement fait 60 octets en tout</li>
 <li>uint32_t string_block_size = FC 8C 04 00 = 298236 =&gt; la taille totale du tableau de caract√®res fait 298236 (soit le m√™me nombre de caract√®res)</li></ul>

<p>Pour faire un lecteur de DBC, il faut donc en priorit√© lire ces donn√©es. Quatre autres "colonnes" suivent, nous ne nous en pr√©occuperons pas dans le cadre de ce tutoriel. Vient ensuite le bloc de donn√©es (de taille Record_count*Record_size) que nous parcourrons pour r√©cup√©rer tous les champs. Enfin vient le bloc de caract√®res (de taille String_block_size) qui vient compl√©ter les donn√©es.</p>

<p>Comme vous le voyez, un fichier DBC n'est pas si complexe une fois qu'on en a saisi le fonctionnement, et nous allons voir dans la partie suivante comment d√©velopper un "simple" lecteur de fichier DBC qui g√©n√©rera un fichier texte contenant les informations des DBCs.</p>

<h2>Partie pratique : extraire les donn√©es et g√©n√©rer un fichier texte</h2>
<h3>Rappel de la structure</h3>

<p>Comme je vous l'ai expliqu√© juste au dessus, la structure est divis√©e en plusieurs sections. Nous allons donc devoir d√©couper notre programme en plusieurs fonctions. La premi√®re sera charg√©e de lire le header du fichier. La seconde aura pour t√¢che d'extraire toutes les donn√©es contenues dans la table, et la troisi√®me r√©cup√®rera un tableau de cha√Ænes de caract√®res identifi√©es par leur index (afin de pouvoir faire le lien simplement avec l'index).</p>

<p>Je ne d√©taillerais pas vraiment le code source, je pense qu'il est suffisamment propre pour √™tre lu</p>

<h3>Identifier le type de chaque variable</h3>

<p>Jusqu'√† pr√©sent, nous sommes partis du principe que nous savions ce que contenait chaque colonne dans la DBC. Or, je suis all√© un peu vite, car si, effectivement, Blizzard sait comment il a structur√© chacune de ces DBCs, nous, nous n'en savons rien. Comment savoir que telle colonne est un entier ? Comment savoir que telle autre contient un offset vers une cha√Æne de caract√®res ? Comment savoir que ce chiffre l√† n'est pas en r√©alit√© un nombre d√©cimal ? Voil√† ce qu'il nous faut trouver.</p>

<p>Je ne vais pas rentrer dans les d√©tails parce que ce n'est pas l'objet du tutoriel et que c'est un poil trop complexe (principalement pour les nombres d√©cimaux), mais je vais tout de m√™me vous donner l'algorithme. Si vous souhaitez voir la version en code, regardez la fonction "identifyColumns".</p>

<p>Donc, dans les grandes lignes, il faut d√©j√† se rappeler une chose, c'est que nous travaillons dans une base de donn√©es. A ce titre, tous les champs d'une colonne donn√©e sont du m√™me type. L'id√©e de l'algorithme est donc de parcourir chaque colonne de la DBC et de trouver de quel type il s'agit.</p>

<p>Pour commencer, je pars du principe que chaque colonne est un chiffre entier (le plus simple). De prime abord, si le chiffre est √©gal √† 0, je ne l'utilise pas pour mes tests (car 0 existe dans un entier, dans un float et dans une cha√Æne de caract√®res (quand aucune cha√Æne n'est assign√©e). Ensuite, je v√©rifie certains bits du nombre afin de v√©rifier s'il pourrait potentiellement √™tre un flottant. Si c'est le cas, je le consid√®re directement comme flottant (√ßa va se v√©rifier tr√®s tr√®s vite avec les valeurs, et la possibilit√© de tomber sur un nombre entier qui se code de la m√™me mani√®re qu'un flottant est tr√®s faible).<br>
Enfin, je v√©rifie si la valeur de l'entier peut correspondre √† une cha√Æne de caract√®res (autrement dit, si l'index existe dans mon tableau de cha√Ænes de caract√®res) apr√®s avoir √©vit√© mes valeurs √©gales √† 1 (car la probabilit√© de tomber sur une erreur est grande). Si, √† la fin de toute ma boucle, je n'ai pas su identifier de contre-exemple au fait que ce soit possiblement une cha√Æne de caract√®res, alors je la consid√®re comme une cha√Æne de caract√®res.</p>

<p>Cet algorithme est loin d'√™tre parfait et cause parfois des erreurs d'appr√©ciation (principalement des entiers identifi√©s comme des flottants par exemple). Cependant, ce sont tr√®s souvent des champs qui ne vous serviront pas pour comprendre et trouver les informations qui vous sont n√©cessaires.</p>

<p>Je vous fournis le code tel quel et ne le commenterais pas, c'est somme toute un programme assez basique. Je vous donne juste les param√®tres :</p>

<pre><code>./dbcreader.py [-hfv -s &lt;semicolon&gt; -o &lt;outputfile&gt;] -i &lt;inputfile&gt;</code><script async="" crossorigin="anonymous" data-hljs-style="github-gist" integrity="sha384-eud4nQrKZMwcYak7or3J5ZPJx1x4HRe8iTTHJy1SUVrDD+fP30Bo/F8OSdQJpk8d" onload="hljsLoader.highlightBlocks(this.parentNode)" src="https://cdn.jsdelivr.net/gh/s9e/hljs-loader@1.0.18/loader.min.js"></script></pre>
 <ul><li><strong>-h</strong> : vous permet d'afficher l'aide (la m√™me chose que ce vous voyez ci-dessus).</li>
 <li><strong>-f</strong> : vous permet d'afficher les informations contenues dans le header ainsi que le format de la dbc (le type de chaque colonne) identifi√© par le programme.</li>
 <li><strong>-v</strong> : vous permet d'activer le mode verbose et d'afficher le r√©sultat dans la console en plus du fichier de sortie (utile pour rediriger la sortie sous linux, par exemple).</li>
 <li><strong>-s &lt;semicolon&gt;</strong> : vous permet de d√©finir le caract√®re de s√©paration dans le fichier de sortie. Par d√©faut ; (point virgule).</li>
 <li><strong>-o &lt;outputfile&gt;</strong> : vous permet de d√©finir le nom du fichier de sortie. Par d√©faut, nom_fichier_entree.csv.</li>
 <li><strong>-i &lt;inputfile&gt;</strong> : seul param√®tre obligatoire, vous permet de d√©finir le fichier d'entr√©e du programme. Doit √™tre un fichier de type dbc.</li></ul>


<p>Et voici le fichier en lui-m√™me. Si des soucis d'antislashs viennent poser probl√®me, cela vient du forum et il vous faudra alors les enlever manuellement.</p>

<pre><code class="language-python">#!/usr/bin/python
import struct
import sys, getopt

def main(filename, argv):
inputfilename = ''
outputfilename = ''
global semicolon
semicolon = ';'
global verbose
verbose = False
showFormat = False
helper = filename+" [-hfv -s &lt;semicolon&gt; -o &lt;outputfile&gt;] -i &lt;inputfile&gt;"+"\n"

try:
opts, args = getopt.getopt(argv,"hfvs:o:i:",["semicolon=", "ifile=", "ofile="])
except getopt.GetoptError:
sys.stdout.write(helper)
sys.exit(1)
for opt, arg in opts:
if opt == '-h':
sys.stdout.write(helper)
sys.exit()
elif opt == "-v":
verbose = True
elif opt in ("-s", "--semicolon"):
semicolon = arg
elif opt in ("-i", "--ifile"):
inputfilename = arg
elif opt in ("-o", "--ofile"):
outputfilename = arg
elif opt == "-f":
showFormat = True

if not inputfilename:
sys.stdout.write(helper)
sys.exit(1)

if not outputfilename:
outputfilename = inputfilename[:-4]+'.csv'

inputfile = open(inputfilename, "rb")
global outputfile
outputfile = open(outputfilename, "w")

try:
WDBC = inputfile.read(4)
if WDBC != "WDBC":
sys.stderr.write("Not supported format\n")
sys.exit(2)

headers = readHeaders(inputfile)
datas = readDatas(inputfile, headers)
skipBytes(inputfile, 1)
strings = readStrings(inputfile, headers)
columns = identifyColumns(headers, datas, strings)
if showFormat:
sys.stdout.write("Headers : "+str(headers)+"\n")
sys.stdout.write("Format : "+''.join(columns)+"\n")
sys.exit(0)
writeData(headers, datas, strings, columns)
finally:
inputfile.close()
outputfile.close()

def write(string):
outputfile.write(string+"\n")
if verbose:
sys.stdout.write(string+"\n")


def writeData(headers, datas, strings, columns):

for rec in xrange(headers["nbrec"]):
recstr = ""
for field in xrange(headers["nbfields"]):
col = columns[field]
if col == 'i':
recstr += str(struct.unpack('i', datas[rec][field])[0]) + semicolon
elif col == 'f':
recstr += str(struct.unpack('f', datas[rec][field])[0]) + semicolon
elif col == 's':
s = struct.unpack('i', datas[rec][field])[0]
if not s:
recstr += "NULL" + semicolon
else:
recstr = recstr + '"'+str(strings[s])+'"' + semicolon
write(recstr)


def identifyColumns(headers, datas,strings):
columns = ['i']*headers["nbfields"]
for field in xrange(headers["nbfields"]):
possiblyAString = True
for rec in xrange(headers["nbrec"]):
value = struct.unpack('i', datas[rec][field])[0]
if not value:
continue
if not (not(value &amp; 0xFF800000) or (value &amp; 0xFF800000 == 0xFF800000)):
columns[field] = 'f'
possiblyAString = False
break
if value != 1 and value not in strings:
possiblyAString = False

if possiblyAString:
columns[field] = 's'
return columns


def readHeaders(inputfile):
headers = {}
headers["nbrec"] = struct.unpack('i', inputfile.read(4))[0]
headers["nbfields"] = struct.unpack('i', inputfile.read(4))[0]
headers["recsize"] = struct.unpack('i', inputfile.read(4))[0]
headers["ssize"] = struct.unpack('i', inputfile.read(4))[0]
return headers

def readDatas(inputfile, headers):
data = []
for irec in xrange(headers["nbrec"]):
rec = []
for jfield in xrange(headers["nbfields"]):
bytes = inputfile.read(4)
rec.append(bytes)
data.append(rec)
return data

def skipBytes(inputfile, count):
inputfile.read(count)

def readStrings(inputfile, headers):
strings = {}
counter = 1
while counter &lt; headers["ssize"]:
s = extractString(inputfile)
strings[counter] = s
counter += len(s)+1
return strings

def extractString(inputfile):
s = ""
car = inputfile.read(1)
while ord(car) != 0:
s = s+car
car = inputfile.read(1)
return s


if __name__ == "__main__":
main(sys.argv[0], sys.argv[1:])</code><script async="" crossorigin="anonymous" data-hljs-style="github-gist" integrity="sha384-eud4nQrKZMwcYak7or3J5ZPJx1x4HRe8iTTHJy1SUVrDD+fP30Bo/F8OSdQJpk8d" onload="hljsLoader.highlightBlocks(this.parentNode)" src="https://cdn.jsdelivr.net/gh/s9e/hljs-loader@1.0.18/loader.min.js"></script></pre>

<p>J'esp√®re que ce tutoriel vous aura plu et que vous serez un peu plus curieux quant aux fichiers que vous utilisez (et pourquoi pas voir un tutoriel sur les fichiers utilis√©s dans les maps et les vmaps par exemple ?) et que vous pourrez √† pr√©sent d√©velopper vos propres outils de lecture ou d'√©criture des DBCs au lieu d'utiliser des logiciels existants, ferm√©s et faisant la plupart du temps la moiti√© du travail que vous souhaitez üòâ</p>

<p><del>Merci √† vous de m'avoir lu, comme toujours, je suis ouvert aux critiques constructives üòâ</del></p>
                </div>
            </div>

            <hr>
            </div>

    
    </div>

</noscript>
<div class="App-composer">
<div class="container">
<div id="composer"></div>
</div>
</div>
</main>
</div>

<div id="modal"></div>
<div id="alerts"></div>
<script>
            document.getElementById('flarum-loading').style.display = 'block';
            var flarum = {extensions: {}};
        </script>
<script src="../assets/forum-2c55cc91.js"></script>
<script src="../assets/forum-fr-b93474b7.js"></script>
<script>
            document.getElementById('flarum-loading').style.display = 'none';

            try {
                flarum.core.app.load({"resources":[{"type":"forums","id":"1","attributes":{"title":"Open WoW","description":"Le forum francophone d\u0027\u00e9mulation WoW.","showLanguageSelector":true,"baseUrl":"https:\/\/forum.open-wow.eu","basePath":"","debug":false,"apiUrl":"https:\/\/forum.open-wow.eu\/api","welcomeTitle":"Bienvene sur Open WoW","welcomeMessage":"Le forum francophone d\u0027\u00e9mulation WoW.","themePrimaryColor":"#4D698E","themeSecondaryColor":"#4D698E","logoUrl":"https:\/\/forum.open-wow.eu\/assets\/logo-fje1vtuv.png","faviconUrl":"https:\/\/forum.open-wow.eu\/assets\/favicon-19klahq3.png","headerHtml":null,"footerHtml":null,"allowSignUp":true,"defaultRoute":"\/all","canViewDiscussions":true,"canStartDiscussion":true,"canViewUserList":false,"canViewFlags":false,"guidelinesUrl":null,"minPrimaryTags":"1","maxPrimaryTags":"1","minSecondaryTags":"0","maxSecondaryTags":"99","canSeeUserDirectoryLink":false,"userDirectoryDefaultSort":"username_az","darkMode":true,"categories.keepTagsNav":false,"categories.fullPageDesktop":false,"categories.compactMobile":false,"categories.parentRemoveIcon":false,"categories.parentRemoveDescription":false,"categories.parentRemoveStats":false,"categories.parentRemoveLastDiscussion":false,"categories.childBareIcon":false,"emojioneAreaEnableSearch":true,"emojioneAreaEnableRecent":true,"emojioneAreaEnableTones":true,"emojioneAreaFiltersPositionBottom":false,"emojioneAreaSearchPositionBottom":false,"emojioneAreaHideFlarumButton":true},"relationships":{"groups":{"data":[{"type":"groups","id":"1"},{"type":"groups","id":"2"},{"type":"groups","id":"3"},{"type":"groups","id":"4"}]},"tags":{"data":[{"type":"tags","id":"1"},{"type":"tags","id":"2"},{"type":"tags","id":"3"},{"type":"tags","id":"9"},{"type":"tags","id":"10"},{"type":"tags","id":"11"},{"type":"tags","id":"12"},{"type":"tags","id":"13"},{"type":"tags","id":"14"},{"type":"tags","id":"15"},{"type":"tags","id":"16"},{"type":"tags","id":"17"},{"type":"tags","id":"18"},{"type":"tags","id":"19"},{"type":"tags","id":"20"},{"type":"tags","id":"21"},{"type":"tags","id":"23"},{"type":"tags","id":"24"},{"type":"tags","id":"25"},{"type":"tags","id":"26"},{"type":"tags","id":"27"},{"type":"tags","id":"28"},{"type":"tags","id":"29"},{"type":"tags","id":"30"},{"type":"tags","id":"31"},{"type":"tags","id":"32"},{"type":"tags","id":"33"},{"type":"tags","id":"34"},{"type":"tags","id":"35"},{"type":"tags","id":"36"},{"type":"tags","id":"37"},{"type":"tags","id":"38"},{"type":"tags","id":"39"},{"type":"tags","id":"40"},{"type":"tags","id":"42"},{"type":"tags","id":"43"}]}}},{"type":"groups","id":"1","attributes":{"nameSingular":"Administrateur","namePlural":"Administrateurs","color":"#B72A2A","icon":"fas fa-wrench","isHidden":0}},{"type":"groups","id":"2","attributes":{"nameSingular":"Invit\u00e9","namePlural":"Invit\u00e9s","color":null,"icon":null,"isHidden":0}},{"type":"groups","id":"3","attributes":{"nameSingular":"Membre","namePlural":"Membres","color":null,"icon":null,"isHidden":0}},{"type":"groups","id":"4","attributes":{"nameSingular":"Mod\u00e9rateur","namePlural":"Mod\u00e9rateurs","color":"#80349E","icon":"fas fa-bolt","isHidden":0}},{"type":"tags","id":"1","attributes":{"name":"General","description":null,"slug":"general","color":"#888","backgroundUrl":null,"backgroundMode":null,"icon":null,"discussionCount":0,"position":0,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":null,"canStartDiscussion":false,"canAddToDiscussion":false,"postCount":0}},{"type":"tags","id":"2","attributes":{"name":"Tutoriels","description":"","slug":"tutoriels","color":"#e74c3c","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":49,"position":2,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-02-18T21:14:17+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":45},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"68"}}}},{"type":"tags","id":"3","attributes":{"name":"Partages","description":"","slug":"partagess","color":"#e74c3c","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":29,"position":3,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-02-12T15:47:42+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":29},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"56"}}}},{"type":"tags","id":"9","attributes":{"name":"Support","description":"","slug":"support","color":"#e74c3c","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":1,"position":4,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-01-04T17:18:38+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":8},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"28"}}}},{"type":"tags","id":"10","attributes":{"name":"C++","description":"","slug":"tuto-cpp","color":"#e74c3c","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":9,"position":1,"defaultSort":null,"isChild":true,"isHidden":false,"lastPostedAt":"2021-02-18T21:08:17+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":6},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"60"}},"parent":{"data":{"type":"tags","id":"2"}}}},{"type":"tags","id":"11","attributes":{"name":"Lua","description":"","slug":"tuto-lua","color":"#e74c3c","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":6,"position":2,"defaultSort":null,"isChild":true,"isHidden":false,"lastPostedAt":"2021-02-18T21:11:18+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":6},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"62"}},"parent":{"data":{"type":"tags","id":"2"}}}},{"type":"tags","id":"12","attributes":{"name":"SQL","description":"","slug":"tuto-sql","color":"#e74c3c","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":9,"position":4,"defaultSort":null,"isChild":true,"isHidden":false,"lastPostedAt":"2021-02-18T21:14:17+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":10},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"68"}},"parent":{"data":{"type":"tags","id":"2"}}}},{"type":"tags","id":"13","attributes":{"name":"Vanilla","description":"","slug":"vanilla","color":"#f39c12","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":12,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-01-07T13:34:50+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":13},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"31"}}}},{"type":"tags","id":"14","attributes":{"name":"The Burning Crusade","description":"","slug":"the-burning-crusade","color":"#f39c12","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":13,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-02-12T15:47:42+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":14},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"56"}}}},{"type":"tags","id":"15","attributes":{"name":"Wrath of the Lich King","description":"","slug":"wrath-of-the-lich-king","color":"#f39c12","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":24,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-02-18T21:04:05+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":27},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"57"}}}},{"type":"tags","id":"16","attributes":{"name":"Cataclysm","description":"","slug":"cataclysm","color":"#f39c12","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":3,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-02-12T15:47:42+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":3},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"56"}}}},{"type":"tags","id":"17","attributes":{"name":"Mists of Pandaria","description":"","slug":"mists-of-pandaria","color":"#f39c12","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":2,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-02-12T15:47:42+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":2},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"56"}}}},{"type":"tags","id":"18","attributes":{"name":"Warlords of Draenor","description":"","slug":"warlords-of-draenor","color":"#f39c12","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":2,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-02-12T15:47:42+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":2},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"56"}}}},{"type":"tags","id":"19","attributes":{"name":"Legion","description":"","slug":"legion","color":"#f39c12","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":2,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-02-12T15:47:42+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":2},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"56"}}}},{"type":"tags","id":"20","attributes":{"name":"Battle for Azeroth","description":"","slug":"battle-for-azeroth","color":"#f39c12","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":2,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-02-12T15:47:42+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":2},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"56"}}}},{"type":"tags","id":"21","attributes":{"name":"Shadowlands","description":"","slug":"shadowlands","color":"#f39c12","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":3,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-02-12T15:47:42+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":3},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"56"}}}},{"type":"tags","id":"23","attributes":{"name":"TrinityCore","description":"","slug":"trinitycore","color":"#9b59b6","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":26,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-02-18T21:04:05+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":25},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"57"}}}},{"type":"tags","id":"24","attributes":{"name":"MaNGOS","description":"","slug":"mangos","color":"#9b59b6","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":10,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-02-12T15:47:42+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":12},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"56"}}}},{"type":"tags","id":"25","attributes":{"name":"AzerothCore","description":"","slug":"azerothcore","color":"#9b59b6","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":19,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-02-12T15:47:42+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":17},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"56"}}}},{"type":"tags","id":"26","attributes":{"name":"Skyfire","description":"","slug":"skyfire","color":"#9b59b6","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":3,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-01-05T13:08:13+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":2},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"30"}}}},{"type":"tags","id":"27","attributes":{"name":"Oregoncore","description":"","slug":"oregoncore","color":"#9b59b6","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":7,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-01-07T13:34:50+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":10},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"31"}}}},{"type":"tags","id":"28","attributes":{"name":"C++","description":"","slug":"cplusplus","color":"#2e86c1","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":2,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-01-09T16:29:34+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":3},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"42"}}}},{"type":"tags","id":"29","attributes":{"name":"SQL","description":"","slug":"sql","color":"#2e86c1","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":9,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-01-09T16:29:34+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":9},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"42"}}}},{"type":"tags","id":"30","attributes":{"name":"Lua","description":"","slug":"lua","color":"#2e86c1","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":15,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-01-18T11:03:06+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":15},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"52"}}}},{"type":"tags","id":"31","attributes":{"name":"PHP","description":"","slug":"php","color":"#2e86c1","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":0,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":null,"canStartDiscussion":false,"canAddToDiscussion":false,"postCount":0}},{"type":"tags","id":"32","attributes":{"name":"C++","description":"","slug":"rel-cpp","color":"#e74c3c","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":1,"position":1,"defaultSort":null,"isChild":true,"isHidden":false,"lastPostedAt":"2021-01-03T18:14:57+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":1},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"26"}},"parent":{"data":{"type":"tags","id":"3"}}}},{"type":"tags","id":"33","attributes":{"name":"Lua","description":"","slug":"rel-lua","color":"#e74c3c","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":11,"position":2,"defaultSort":null,"isChild":true,"isHidden":false,"lastPostedAt":"2021-01-23T20:31:12+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":10},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"54"}},"parent":{"data":{"type":"tags","id":"3"}}}},{"type":"tags","id":"34","attributes":{"name":"SQL","description":"","slug":"rel-sql","color":"#e74c3c","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":6,"position":4,"defaultSort":null,"isChild":true,"isHidden":false,"lastPostedAt":"2021-01-09T19:51:41+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":6},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"50"}},"parent":{"data":{"type":"tags","id":"3"}}}},{"type":"tags","id":"35","attributes":{"name":"GIT","description":"","slug":"git","color":"#2e86c1","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":1,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2020-12-31T12:21:21+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":1},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"8"}}}},{"type":"tags","id":"36","attributes":{"name":"windows","description":"","slug":"windows","color":"#27ae60","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":4,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-02-18T21:04:05+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":7},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"57"}}}},{"type":"tags","id":"37","attributes":{"name":"Linux","description":"","slug":"linux","color":"#27ae60","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":4,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-02-18T21:04:05+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":5},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"57"}}}},{"type":"tags","id":"38","attributes":{"name":"Guides","description":"","slug":"guides","color":"#00FFF7","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":2,"position":1,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-02-13T21:59:45+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":6},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"20"}}}},{"type":"tags","id":"39","attributes":{"name":"Autres","description":"","slug":"tuto-autres","color":"#e74c3c","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":2,"position":0,"defaultSort":null,"isChild":true,"isHidden":false,"lastPostedAt":"2021-02-03T20:18:27+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":2},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"55"}},"parent":{"data":{"type":"tags","id":"2"}}}},{"type":"tags","id":"40","attributes":{"name":"Autres","description":"","slug":"rel-autres","color":"#e74c3c","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":5,"position":0,"defaultSort":null,"isChild":true,"isHidden":false,"lastPostedAt":"2021-01-27T08:52:01+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":6},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"53"}},"parent":{"data":{"type":"tags","id":"3"}}}},{"type":"tags","id":"42","attributes":{"name":"Model-changing","description":"","slug":"tuto-model-changing","color":"#e74c3c","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":0,"position":3,"defaultSort":null,"isChild":true,"isHidden":false,"lastPostedAt":null,"canStartDiscussion":false,"canAddToDiscussion":false,"postCount":0},"relationships":{"parent":{"data":{"type":"tags","id":"2"}}}},{"type":"tags","id":"43","attributes":{"name":"Model-Changing","description":"","slug":"rel-model-changing","color":"#e74c3c","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":0,"position":3,"defaultSort":null,"isChild":true,"isHidden":false,"lastPostedAt":null,"canStartDiscussion":false,"canAddToDiscussion":false,"postCount":0},"relationships":{"parent":{"data":{"type":"tags","id":"3"}}}},{"type":"discussions","id":"68","attributes":{"title":"Les conditions","slug":"68-les-conditions","commentCount":1,"participantCount":1,"createdAt":"2021-02-18T21:14:17+00:00","lastPostedAt":"2021-02-18T21:14:17+00:00","lastPostNumber":1,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"2"}}}},{"type":"discussions","id":"56","attributes":{"title":"WoW Admin Panel Prenium","slug":"56-wow-admin-panel-prenium","commentCount":1,"participantCount":1,"createdAt":"2021-02-12T15:47:42+00:00","lastPostedAt":"2021-02-12T15:47:42+00:00","lastPostNumber":1,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"19"}}}},{"type":"discussions","id":"28","attributes":{"title":"Comment extraire les Vmaps sur des donjons modifier ?","slug":"28-comment-extraire-les-vmaps-sur-des-donjons-modifier","commentCount":8,"participantCount":4,"createdAt":"2021-01-03T22:30:02+00:00","lastPostedAt":"2021-01-04T19:13:07+00:00","lastPostNumber":8,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"8"}}}},{"type":"discussions","id":"60","attributes":{"title":"Mini Boss","slug":"60-mini-boss","commentCount":1,"participantCount":1,"createdAt":"2021-02-18T21:08:17+00:00","lastPostedAt":"2021-02-18T21:08:17+00:00","lastPostNumber":1,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"2"}}}},{"type":"discussions","id":"62","attributes":{"title":"Stocker des informations avec Eluna","slug":"62-stocker-des-informations-avec-eluna","commentCount":1,"participantCount":1,"createdAt":"2021-02-18T21:11:18+00:00","lastPostedAt":"2021-02-18T21:11:18+00:00","lastPostNumber":1,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"2"}}}},{"type":"discussions","id":"31","attributes":{"title":"LIC - Lua Icons Chat","slug":"31-lic-lua-icons-chat","commentCount":1,"participantCount":1,"createdAt":"2021-01-07T13:34:50+00:00","lastPostedAt":"2021-01-07T13:34:50+00:00","lastPostNumber":1,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"2"}}}},{"type":"discussions","id":"57","attributes":{"title":"Anti_Farm","slug":"57-anti-farm","commentCount":2,"participantCount":2,"createdAt":"2021-02-18T21:04:05+00:00","lastPostedAt":"2021-02-18T21:08:49+00:00","lastPostNumber":4,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"13"}}}},{"type":"discussions","id":"30","attributes":{"title":"Modifier la distance de vue","slug":"30-modifier-la-distance-de-vue","commentCount":1,"participantCount":1,"createdAt":"2021-01-05T13:08:13+00:00","lastPostedAt":"2021-01-05T13:08:13+00:00","lastPostNumber":1,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"2"}}}},{"type":"discussions","id":"42","attributes":{"title":"Les Bitmasks - Fonctionnement et Exemples","slug":"42-les-bitmasks-fonctionnement-et-exemples","commentCount":2,"participantCount":2,"createdAt":"2021-01-09T16:29:34+00:00","lastPostedAt":"2021-02-12T20:57:11+00:00","lastPostNumber":2,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"13"}}}},{"type":"discussions","id":"52","attributes":{"title":"Texture Coords Calculator","slug":"52-texture-coords-calculator","commentCount":1,"participantCount":1,"createdAt":"2021-01-18T11:03:06+00:00","lastPostedAt":"2021-01-18T11:03:06+00:00","lastPostNumber":1,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"2"}}}},{"type":"discussions","id":"26","attributes":{"title":"Activer les races alli\u00e9es ","slug":"26-activer-les-races-alliees","commentCount":1,"participantCount":1,"createdAt":"2021-01-03T18:14:57+00:00","lastPostedAt":"2021-01-03T18:14:57+00:00","lastPostNumber":1,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"1"}}}},{"type":"discussions","id":"54","attributes":{"title":"[AddOn] TrinityAdmin","slug":"54-addon-trinityadmin","commentCount":1,"participantCount":1,"createdAt":"2021-01-23T20:31:12+00:00","lastPostedAt":"2021-01-23T20:31:12+00:00","lastPostNumber":1,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"15"}}}},{"type":"discussions","id":"50","attributes":{"title":"Gameobject Paramystick","slug":"50-gameobject-paramystick","commentCount":1,"participantCount":1,"createdAt":"2021-01-09T19:51:41+00:00","lastPostedAt":"2021-01-09T19:51:41+00:00","lastPostNumber":1,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"1"}}}},{"type":"discussions","id":"8","attributes":{"title":"Cloner une version particuli\u00e8re de TrinityCore","slug":"8-cloner-une-version-particuliere-de-trinitycore","commentCount":1,"participantCount":1,"createdAt":"2020-12-31T12:21:21+00:00","lastPostedAt":"2020-12-31T12:21:21+00:00","lastPostNumber":1,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"1"}}}},{"type":"discussions","id":"20","attributes":{"title":"Apprendre le Lua : Session #2","slug":"20-apprendre-le-lua-session-2","commentCount":4,"participantCount":2,"createdAt":"2020-12-31T17:23:56+00:00","lastPostedAt":"2021-02-18T21:02:03+00:00","lastPostNumber":4,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"2"}}}},{"type":"discussions","id":"55","attributes":{"title":"Cr\u00e9er une nouvelle Map","slug":"55-creer-une-nouvelle-map","commentCount":1,"participantCount":1,"createdAt":"2021-02-03T20:18:27+00:00","lastPostedAt":"2021-02-03T20:18:27+00:00","lastPostNumber":1,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"18"}}}},{"type":"discussions","id":"53","attributes":{"title":"WoW Client Manager","slug":"53-wow-client-manager","commentCount":3,"participantCount":2,"createdAt":"2021-01-20T20:08:53+00:00","lastPostedAt":"2021-01-27T16:51:32+00:00","lastPostNumber":3,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"1"}}}},{"type":"users","id":"2","attributes":{"username":"iThorgrim","displayName":"iThorgrim","avatarUrl":"https:\/\/forum.open-wow.eu\/assets\/avatars\/m2uNfA3ykacYo3KQ.png","slug":"iThorgrim","joinTime":null}},{"type":"users","id":"19","attributes":{"username":"Torvahal","displayName":"Torvahal","avatarUrl":"https:\/\/forum.open-wow.eu\/assets\/avatars\/Zj382QMdGN5T05KR.png","slug":"Torvahal","joinTime":null}},{"type":"users","id":"8","attributes":{"username":"Shard","displayName":"Shard","avatarUrl":"https:\/\/forum.open-wow.eu\/assets\/avatars\/bYoQgxVXNpTYgA1Z.png","slug":"Shard","joinTime":null}},{"type":"users","id":"13","attributes":{"username":"noc","displayName":"noc","avatarUrl":null,"slug":"noc","joinTime":null}},{"type":"users","id":"1","attributes":{"username":"Galathil","displayName":"Galathil","avatarUrl":"https:\/\/forum.open-wow.eu\/assets\/avatars\/6zjneQm6RzYl44hc.png","slug":"Galathil","joinTime":null}},{"type":"users","id":"15","attributes":{"username":"Mageex","displayName":"Mageex","avatarUrl":"https:\/\/forum.open-wow.eu\/assets\/avatars\/QrVwmaDacwoX2c40.png","slug":"Mageex","joinTime":null}},{"type":"users","id":"18","attributes":{"username":"Nehyren","displayName":"Nehyren","avatarUrl":"https:\/\/forum.open-wow.eu\/assets\/avatars\/JTiwGMIn9vWbQRVE.png","slug":"Nehyren","joinTime":null}}],"session":{"userId":0,"csrfToken":"WUsixhulA0w9w9bBCoppu794ho1DLo5uZod22tP2"},"locales":{"fr":"Fran\u00e7ais","en":"English"},"locale":"fr","fof-recaptcha.credentials.site":"6LfKZhoaAAAAALSGOmOPpIVRVM8XRksALQXeFtYW","fof-recaptcha.type":"","apiDocument":{"data":{"type":"discussions","id":"34","attributes":{"title":"Le format DBC","slug":"34-le-format-dbc","commentCount":1,"participantCount":1,"createdAt":"2021-01-09T12:00:18+00:00","lastPostedAt":"2021-01-09T12:00:18+00:00","lastPostNumber":1,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"posts":{"data":[{"type":"posts","id":"59"}]},"tags":{"data":[{"type":"tags","id":"2"}]}}},"included":[{"type":"posts","id":"59","attributes":{"number":1,"createdAt":"2021-01-09T12:00:18+00:00","contentType":"comment","contentHtml":"\u003Cp\u003E\u003Cstrong\u003EImportant :\u003C\/strong\u003E Ce tutoriel a \u00e9t\u00e9 r\u00e9dig\u00e9 par Nobodie pour le site wow-emu.fr. Je le recopie ici \u00e0 l\u0027identique, Il se peut que certaines informations soient obsol\u00e8tes \u00e0 ce jour. Bonne lecture !\u003C\/p\u003E\n\n\u003Ch1\u003ELe format DBC\u003C\/h1\u003E\n\n\u003Cp\u003EBonsoir \u00e0 tous,\u003C\/p\u003E\n\n\u003Cp\u003Esuite \u00e0 diff\u00e9rents sujets et demandes en interne au sujet des DBC, j\u0027\u00e9cris donc ce tutoriel aujourd\u0027hui afin de comprendre exactement ce qu\u0027il en est. Nous verrons donc d\u0027abord ce qu\u0027est ce format de fichier, \u00e0 quoi il ressemble et comment le lire, puis nous verrons un petit script python capable de g\u00e9n\u00e9rer un fichier texte repr\u00e9sentant les donn\u00e9es qu\u0027il contient. Bonne lecture \u00e0 vous \ud83d\ude09\u003C\/p\u003E\n\n\u003Cp\u003ECe tutoriel est bas\u00e9 sur mes travaux personnels et sur une page qui m\u0027a beaucoup aid\u00e9 \u00e0 l\u0027\u00e9poque ou je n\u0027y connaissais rien : \u003Cdel\u003E\u003Ca href=\u0022http:\/\/www.pxr.dk\/wowdev\/wiki\/index.php?title=DBC\u0022 rel=\u0022 nofollow ugc\u0022\u003Ehttp:\/\/www.pxr.dk\/wowdev\/wiki\/index.php?title=DBC\u003C\/a\u003E\u003C\/del\u003E Une portion de ce sujet sera copi\u00e9e ici et traduite pour la communaut\u00e9 fran\u00e7aise.\u003C\/p\u003E\n\n\u003Ch2\u003EPartie th\u00e9orique : les fichiers DBC\u003C\/h2\u003E\n\u003Ch3\u003EQu\u0027est-ce qu\u0027un fichier DBC ?\u003C\/h3\u003E\n\n\u003Cp\u003EUn fichier .DBC n\u0027est ni plus ni moins que l\u0027\u00e9quivalent en SQL d\u0027une table. Ce format contient donc des informations num\u00e9riques ou textuelles sous forme binaire. Exit donc les mod\u00e8les 3D, les cin\u00e9matiques ou que sais-je encore.\u003C\/p\u003E\n\n\u003Cp\u003ELe format DBC est utilis\u00e9 par Blizzard depuis la premi\u00e8re version de WoW. Jusqu\u0027\u00e0 l\u0027extension Warlords of Draenor, celles-ci \u00e9taient accessibles via leurs fichiers propri\u00e9taires MoPaQs (les incontournables MPQs), et sont maintenant contenues sous une forme l\u00e9g\u00e8rement diff\u00e9rentes dans leur nouveau syst\u00e8me appel\u00e9 CASC (dont je ne parlerais pas ici).\u003C\/p\u003E\n\n\u003Cp\u003EIl existe une autre version \u0022\u00e9volu\u00e9e\u0022 des DBC que l\u0027on appelle les DB2. Leur format est quasiment identique, \u00e0 ceci pr\u00e8s que toutes les donn\u00e9es pr\u00e9sentes dans les fichiers DB2 peuvent \u00eatre overwrit\u00e9s par le serveur de jeu de fa\u00e7on invisible pour les joueurs. Il n\u0027est donc pas n\u00e9cessaire \u00e0 Blizzard d\u0027effectuer une mise \u00e0 jour pour corriger une donn\u00e9e dans celles-ci, par exemple. Nous ne traiterons pas les fichiers .DB2 ici, sachez simplement que le format est quasiment identique.\u003C\/p\u003E\n\n\u003Ch3\u003EPourquoi ces fichiers se retrouvent-ils sur un serveur priv\u00e9 ?\u003C\/h3\u003E\n\n\u003Cp\u003ESi vous avez lu mon tutoriel sur le fonctionnement d\u0027un serveur priv\u00e9 (disponible ici : \u003Ca href=\u0022http:\/\/wow-emu.fr\/showthread.php?tid=167\u0022 rel=\u0022 nofollow ugc\u0022\u003Ehttp:\/\/wow-emu.fr\/showthread.php?tid=167\u003C\/a\u003E), vous savez que le serveur a besoin d\u0027un certain nombre d\u0027informations en provenance du client. Les DBCs en font partie. Le principal challenge d\u0027un serveur priv\u00e9 est de se confronter \u00e0 la masse ph\u00e9nom\u00e9nale de contenu disponible sur officiel. Ainsi, au lieu de cr\u00e9er tout serveur \u00e0 partir de z\u00e9ro, les d\u00e9veloppeurs ont choisi d\u0027extraire un certain nombre d\u0027informations \u00e0 partir du client afin d\u0027avoir une base \u0022saine\u0022 \u00e0 partir de laquelle ils peuvent extraire un certain nombre d\u0027informations. C\u0027est entre autres gr\u00e2ce \u00e0 ces bases qu\u0027on poss\u00e8de les informations sur les sorts, les zones, les ma\u00eetres de vol, etc etc.\u003C\/p\u003E\n\n\u003Cp\u003ECependant, si vous avez bien suivi, les DBCs ne sont qu\u0027un fichier de stockage, il n\u0027y a aucune information sur ce qu\u0027elles contiennent ni comment elles s\u0027articulent les unes par rapport aux autres. Ce travail reste donc \u00e0 la charge des d\u00e9veloppeurs de serveurs priv\u00e9s qui doivent alors identifier chaque colonne pour en comprendre la signification et l\u0027utilit\u00e9.\u003C\/p\u003E\n\n\u003Ch3\u003EA quoi ressemble un fichier DBC ?\u003C\/h3\u003E\n\n\u003Cp\u003EUn fichier DBC est un fichier binaire. Si vous l\u0027ouvrez avec Notepad++ par exemple, vous verrez un tas de caract\u00e8res qui ne vous diront rien.\u003C\/p\u003E\n\n\u003Cp\u003ESi vous l\u0027ouvrez avec un \u00e9diteur hexad\u00e9cimal, vous y verrez tout un tas de chiffres, qui ne vous diront rien non plus \ud83d\ude00\u003C\/p\u003E\n\n\u003Cp\u003EPourtant, l\u0027ensemble des chiffres que vous voyez devant votre \u00e9cran fait pourtant partie de la mati\u00e8re pure des DBCs que vous convoitez. Ces chiffres l\u00e0, une fois bien d\u00e9coup\u00e9s vous permettrons d\u0027obtenir n\u0027importe quelle information contenue dans la DBC et vous pourrez alors en fait ce que vous voulez - en g\u00e9n\u00e9rer un fichier texte ou un ensemble de requ\u00eates SQL par exemple.\u003C\/p\u003E\n\n\u003Ch3\u003EQuelle est la structure des fichiers DBC ?\u003C\/h3\u003E\n\n\u003Cp\u003EPour cela, je vais me baser sur le wiki dont j\u0027ai post\u00e9 le lien au d\u00e9but.\u003Cbr\u003E\nVoici basiquement \u00e0 quoi ressemble la structure d\u0027une DBC :\u003C\/p\u003E\n\n\u003Cpre\u003E\u003Ccode class=\u0022language-cpp\u0022\u003Estruct dbc_header\n{\nuint32_t magic;\nuint32_t record_count;\nuint32_t field_count;\nuint32_t record_size;\nuint32_t string_block_size;\n};\n\ntemplate\u0026lt;typename record_type\u0026gt;\nstruct dbc_file\n{\ndbc_header header;\nrecord_type records[header.record_count];\nchar string_block[header.string_block_size];\n};\u003C\/code\u003E\u003Cscript async=\u0022\u0022 crossorigin=\u0022anonymous\u0022 data-hljs-style=\u0022github-gist\u0022 integrity=\u0022sha384-eud4nQrKZMwcYak7or3J5ZPJx1x4HRe8iTTHJy1SUVrDD+fP30Bo\/F8OSdQJpk8d\u0022 onload=\u0022hljsLoader.highlightBlocks(this.parentNode)\u0022 src=\u0022https:\/\/cdn.jsdelivr.net\/gh\/s9e\/hljs-loader@1.0.18\/loader.min.js\u0022\u003E\u003C\/script\u003E\u003C\/pre\u003E\n\n\u003Cp\u003ECette structure est somme toute assez simple. Analysons-l\u00e0 ensemble \ud83d\ude09\u003C\/p\u003E\n\n\u003Cp\u003ELa premi\u00e8re partie constitue ce qu\u0027on appelle les DbcHeaders. Ils permettent d\u0027obtenir un certain nombre d\u0027informations sur la DBC et contient 5 variables num\u00e9riques.\u003C\/p\u003E\n\n\u003Cpre\u003E\u003Ccode class=\u0022language-cpp\u0022\u003Estruct dbc_header\n{\nuint32_t magic;\nuint32_t record_count;\nuint32_t field_count;\nuint32_t record_size;\nuint32_t string_block_size;\n};\u003C\/code\u003E\u003Cscript async=\u0022\u0022 crossorigin=\u0022anonymous\u0022 data-hljs-style=\u0022github-gist\u0022 integrity=\u0022sha384-eud4nQrKZMwcYak7or3J5ZPJx1x4HRe8iTTHJy1SUVrDD+fP30Bo\/F8OSdQJpk8d\u0022 onload=\u0022hljsLoader.highlightBlocks(this.parentNode)\u0022 src=\u0022https:\/\/cdn.jsdelivr.net\/gh\/s9e\/hljs-loader@1.0.18\/loader.min.js\u0022\u003E\u003C\/script\u003E\u003C\/pre\u003E\n\n\u003Cp\u003ELa premi\u00e8re valeur contient, pour un fichier DBC, la valeur 1464091203. C\u0027est ce qui permet d\u0027identifier le fichier et de savoir qu\u0027il s\u0027agit d\u0027un fichier DBC. Cette valeur est de prime abord assez barbare, mais quand on y regarde de plus pr\u00e8s elle prend tout son sens.\u003C\/p\u003E\n\n\u003Cp\u003E1464091203 vaut en h\u00e9xad\u00e9cimal 0x57444243. Cela nous donne donc 4 octets, 0x57, 0x44, 0x42 et 0x43. Ces quatre valeurs correspondent en fait aux quatre lettres W, D, B et C. Vous pouvez le v\u00e9rifier en allant sur ce site \u003Ca href=\u0022http:\/\/www.dolcevie.com\/js\/converter.html\u0022 rel=\u0022 nofollow ugc\u0022\u003Ehttp:\/\/www.dolcevie.com\/js\/converter.html\u003C\/a\u003E par exemple.\u003C\/p\u003E\n\n\u003Cp\u003EQuand vous voyez un fichier .wdb, c\u0027est en fait un fichier dbc. En r\u00e9alit\u00e9, lorsque le fichier ne contient aucune extension, la plupart des logiciels tentent de trouver leur nom et par convention, beaucoup de formats \u0022consomment\u0022 les trois premiers octets du fichier pour indiquer l\u0027extension. C\u0027est pour cette raison qu\u0027un dezippeur renomme les fichiers en .wdb par exemple\u003C\/p\u003E\n\n\u003Cp\u003ELes trois valeurs suivantes sont plus simples. Nous allons prendre le cas d\u0027une table SQL.\u003C\/p\u003E\n \u003Cul\u003E\u003Cli\u003ERecord_count contient le nombre d\u0027enregistrements (autrement dit, le nombre de \u0022lignes\u0022 dans une table SQL) que contient le fichier DBC.\u003C\/li\u003E\n \u003Cli\u003EField_count contient le nombre de champs (autrement dit, le nombre de \u0022colonnes\u0022 dans une table SQL) que contient le fichier DBC.\u003C\/li\u003E\n \u003Cli\u003ERecord_size contient la taille en octets d\u0027un enregistrement (autrement dit, la taille en m\u00e9moire d\u0027une \u0022ligne\u0022 dans une table SQL). Il faut savoir que dans la plupart des cas (on va dire 99% pour se laisser une l\u00e9g\u00e8re marge) une donn\u00e9e dans les DBCs fait 4 octets (la taille d\u0027un uint32). le Record_size vaut donc tr\u00e8s souvent 4*Field_count. Cependant, dans de rares cas cela diff\u00e8re et c\u0027est \u00e0 \u00e7a que sert cette valeur.\u003C\/li\u003E\u003C\/ul\u003E\n\n\u003Cp\u003ELa derni\u00e8re valeur est un peu diff\u00e9rente. Nous venons de dire que chaque donn\u00e9e dans une DBC est stock\u00e9e sur 4 octets. Or, nous avons vu aussi que pour \u00e9crire WDBC (une cha\u00eene de caract\u00e8res), il nous fallait \u00e9galement 4 octets. Que faire alors si dans une DBC, Blizzard souhaite enregistrer une cha\u00eene de caract\u00e8res de plus de quatre octets ? Il y a en r\u00e9alit\u00e9 une seconde zone de donn\u00e9es (un second tableau, plus pr\u00e9cis\u00e9ment) qui contiendra absolument toutes les cha\u00eenes de caract\u00e8res. Et au lieu d\u0027enregistrer la cha\u00eene dans le premier tableau, on enregistre une variable qui contient l\u0027offset de la cha\u00eene de caract\u00e8re dans le second tableau. Cela parait un peu complexe, mais ce n\u0027est ni plus ni moins qu\u0027un pointeur vers une case en m\u00e9moire, l\u0027avantage \u00e9tant que ce pointeur-l\u00e0 peut \u00eatre stock\u00e9 dans une variable de 4 octets. Nous verrons lors de la mise en pratique que cela va nous poser quelques soucis si nous voulons identifier automatiquement le type des champs.\u003C\/p\u003E\n\n\u003Cp\u003ELa derni\u00e8re variable contient donc ni plus ni moins que la taille en m\u00e9moire du tableau de cha\u00eenes de caract\u00e8res.\u003C\/p\u003E\n\n\u003Cp\u003EPrenons un exemple avec la DBC Achievement, dont voici les premiers octets :\u003C\/p\u003E\n\n\u003Cpre\u003E\u003Ccode\u003E...\n57444243F70C00000F0000003C000000FC8C040006000000FFFFFFFFFFFFFFFF00000000010000000B000000\n...\u003C\/code\u003E\u003Cscript async=\u0022\u0022 crossorigin=\u0022anonymous\u0022 data-hljs-style=\u0022github-gist\u0022 integrity=\u0022sha384-eud4nQrKZMwcYak7or3J5ZPJx1x4HRe8iTTHJy1SUVrDD+fP30Bo\/F8OSdQJpk8d\u0022 onload=\u0022hljsLoader.highlightBlocks(this.parentNode)\u0022 src=\u0022https:\/\/cdn.jsdelivr.net\/gh\/s9e\/hljs-loader@1.0.18\/loader.min.js\u0022\u003E\u003C\/script\u003E\u003C\/pre\u003E\n\n\u003Cp\u003EEt une fois d\u00e9coup\u00e9s en groupes de 4 octets :\u003C\/p\u003E\n\n\u003Cpre\u003E\u003Ccode\u003E...\n57 44 42 43 F7 0C 00 00 0F 00 00 00 3C 00 00 00 FC 8C 04 00 06 00 00 00 FF FF FF FF FF FF FF FF 00 00 00 00 01 00 00 00 0B 00 00 00\n...\u003C\/code\u003E\u003Cscript async=\u0022\u0022 crossorigin=\u0022anonymous\u0022 data-hljs-style=\u0022github-gist\u0022 integrity=\u0022sha384-eud4nQrKZMwcYak7or3J5ZPJx1x4HRe8iTTHJy1SUVrDD+fP30Bo\/F8OSdQJpk8d\u0022 onload=\u0022hljsLoader.highlightBlocks(this.parentNode)\u0022 src=\u0022https:\/\/cdn.jsdelivr.net\/gh\/s9e\/hljs-loader@1.0.18\/loader.min.js\u0022\u003E\u003C\/script\u003E\u003C\/pre\u003E\n\n\u003Cp\u003EOn a donc :\u003C\/p\u003E\n \u003Cul\u003E\u003Cli\u003Euint32_t magic = 57 44 42 43 = \u0022WDBC\u0022 =\u0026gt; on est bien dans un fichier de type DBC.\u003C\/li\u003E\n \u003Cli\u003Euint32_t record_count = F7 0C 00 00 = 3199 =\u0026gt; il y a 3199 enregistrements\u003C\/li\u003E\n \u003Cli\u003Euint32_t field_count = 0F 00 00 00 = 15 =\u0026gt; il y a 15 colonnes par enregistrement\u003C\/li\u003E\n \u003Cli\u003Euint32_t record_size = 3C 00 00 00 = 60 =\u0026gt; chaque enregistrement fait 60 octets en tout\u003C\/li\u003E\n \u003Cli\u003Euint32_t string_block_size = FC 8C 04 00 = 298236 =\u0026gt; la taille totale du tableau de caract\u00e8res fait 298236 (soit le m\u00eame nombre de caract\u00e8res)\u003C\/li\u003E\u003C\/ul\u003E\n\n\u003Cp\u003EPour faire un lecteur de DBC, il faut donc en priorit\u00e9 lire ces donn\u00e9es. Quatre autres \u0022colonnes\u0022 suivent, nous ne nous en pr\u00e9occuperons pas dans le cadre de ce tutoriel. Vient ensuite le bloc de donn\u00e9es (de taille Record_count*Record_size) que nous parcourrons pour r\u00e9cup\u00e9rer tous les champs. Enfin vient le bloc de caract\u00e8res (de taille String_block_size) qui vient compl\u00e9ter les donn\u00e9es.\u003C\/p\u003E\n\n\u003Cp\u003EComme vous le voyez, un fichier DBC n\u0027est pas si complexe une fois qu\u0027on en a saisi le fonctionnement, et nous allons voir dans la partie suivante comment d\u00e9velopper un \u0022simple\u0022 lecteur de fichier DBC qui g\u00e9n\u00e9rera un fichier texte contenant les informations des DBCs.\u003C\/p\u003E\n\n\u003Ch2\u003EPartie pratique : extraire les donn\u00e9es et g\u00e9n\u00e9rer un fichier texte\u003C\/h2\u003E\n\u003Ch3\u003ERappel de la structure\u003C\/h3\u003E\n\n\u003Cp\u003EComme je vous l\u0027ai expliqu\u00e9 juste au dessus, la structure est divis\u00e9e en plusieurs sections. Nous allons donc devoir d\u00e9couper notre programme en plusieurs fonctions. La premi\u00e8re sera charg\u00e9e de lire le header du fichier. La seconde aura pour t\u00e2che d\u0027extraire toutes les donn\u00e9es contenues dans la table, et la troisi\u00e8me r\u00e9cup\u00e8rera un tableau de cha\u00eenes de caract\u00e8res identifi\u00e9es par leur index (afin de pouvoir faire le lien simplement avec l\u0027index).\u003C\/p\u003E\n\n\u003Cp\u003EJe ne d\u00e9taillerais pas vraiment le code source, je pense qu\u0027il est suffisamment propre pour \u00eatre lu\u003C\/p\u003E\n\n\u003Ch3\u003EIdentifier le type de chaque variable\u003C\/h3\u003E\n\n\u003Cp\u003EJusqu\u0027\u00e0 pr\u00e9sent, nous sommes partis du principe que nous savions ce que contenait chaque colonne dans la DBC. Or, je suis all\u00e9 un peu vite, car si, effectivement, Blizzard sait comment il a structur\u00e9 chacune de ces DBCs, nous, nous n\u0027en savons rien. Comment savoir que telle colonne est un entier ? Comment savoir que telle autre contient un offset vers une cha\u00eene de caract\u00e8res ? Comment savoir que ce chiffre l\u00e0 n\u0027est pas en r\u00e9alit\u00e9 un nombre d\u00e9cimal ? Voil\u00e0 ce qu\u0027il nous faut trouver.\u003C\/p\u003E\n\n\u003Cp\u003EJe ne vais pas rentrer dans les d\u00e9tails parce que ce n\u0027est pas l\u0027objet du tutoriel et que c\u0027est un poil trop complexe (principalement pour les nombres d\u00e9cimaux), mais je vais tout de m\u00eame vous donner l\u0027algorithme. Si vous souhaitez voir la version en code, regardez la fonction \u0022identifyColumns\u0022.\u003C\/p\u003E\n\n\u003Cp\u003EDonc, dans les grandes lignes, il faut d\u00e9j\u00e0 se rappeler une chose, c\u0027est que nous travaillons dans une base de donn\u00e9es. A ce titre, tous les champs d\u0027une colonne donn\u00e9e sont du m\u00eame type. L\u0027id\u00e9e de l\u0027algorithme est donc de parcourir chaque colonne de la DBC et de trouver de quel type il s\u0027agit.\u003C\/p\u003E\n\n\u003Cp\u003EPour commencer, je pars du principe que chaque colonne est un chiffre entier (le plus simple). De prime abord, si le chiffre est \u00e9gal \u00e0 0, je ne l\u0027utilise pas pour mes tests (car 0 existe dans un entier, dans un float et dans une cha\u00eene de caract\u00e8res (quand aucune cha\u00eene n\u0027est assign\u00e9e). Ensuite, je v\u00e9rifie certains bits du nombre afin de v\u00e9rifier s\u0027il pourrait potentiellement \u00eatre un flottant. Si c\u0027est le cas, je le consid\u00e8re directement comme flottant (\u00e7a va se v\u00e9rifier tr\u00e8s tr\u00e8s vite avec les valeurs, et la possibilit\u00e9 de tomber sur un nombre entier qui se code de la m\u00eame mani\u00e8re qu\u0027un flottant est tr\u00e8s faible).\u003Cbr\u003E\nEnfin, je v\u00e9rifie si la valeur de l\u0027entier peut correspondre \u00e0 une cha\u00eene de caract\u00e8res (autrement dit, si l\u0027index existe dans mon tableau de cha\u00eenes de caract\u00e8res) apr\u00e8s avoir \u00e9vit\u00e9 mes valeurs \u00e9gales \u00e0 1 (car la probabilit\u00e9 de tomber sur une erreur est grande). Si, \u00e0 la fin de toute ma boucle, je n\u0027ai pas su identifier de contre-exemple au fait que ce soit possiblement une cha\u00eene de caract\u00e8res, alors je la consid\u00e8re comme une cha\u00eene de caract\u00e8res.\u003C\/p\u003E\n\n\u003Cp\u003ECet algorithme est loin d\u0027\u00eatre parfait et cause parfois des erreurs d\u0027appr\u00e9ciation (principalement des entiers identifi\u00e9s comme des flottants par exemple). Cependant, ce sont tr\u00e8s souvent des champs qui ne vous serviront pas pour comprendre et trouver les informations qui vous sont n\u00e9cessaires.\u003C\/p\u003E\n\n\u003Cp\u003EJe vous fournis le code tel quel et ne le commenterais pas, c\u0027est somme toute un programme assez basique. Je vous donne juste les param\u00e8tres :\u003C\/p\u003E\n\n\u003Cpre\u003E\u003Ccode\u003E.\/dbcreader.py [-hfv -s \u0026lt;semicolon\u0026gt; -o \u0026lt;outputfile\u0026gt;] -i \u0026lt;inputfile\u0026gt;\u003C\/code\u003E\u003Cscript async=\u0022\u0022 crossorigin=\u0022anonymous\u0022 data-hljs-style=\u0022github-gist\u0022 integrity=\u0022sha384-eud4nQrKZMwcYak7or3J5ZPJx1x4HRe8iTTHJy1SUVrDD+fP30Bo\/F8OSdQJpk8d\u0022 onload=\u0022hljsLoader.highlightBlocks(this.parentNode)\u0022 src=\u0022https:\/\/cdn.jsdelivr.net\/gh\/s9e\/hljs-loader@1.0.18\/loader.min.js\u0022\u003E\u003C\/script\u003E\u003C\/pre\u003E\n \u003Cul\u003E\u003Cli\u003E\u003Cstrong\u003E-h\u003C\/strong\u003E : vous permet d\u0027afficher l\u0027aide (la m\u00eame chose que ce vous voyez ci-dessus).\u003C\/li\u003E\n \u003Cli\u003E\u003Cstrong\u003E-f\u003C\/strong\u003E : vous permet d\u0027afficher les informations contenues dans le header ainsi que le format de la dbc (le type de chaque colonne) identifi\u00e9 par le programme.\u003C\/li\u003E\n \u003Cli\u003E\u003Cstrong\u003E-v\u003C\/strong\u003E : vous permet d\u0027activer le mode verbose et d\u0027afficher le r\u00e9sultat dans la console en plus du fichier de sortie (utile pour rediriger la sortie sous linux, par exemple).\u003C\/li\u003E\n \u003Cli\u003E\u003Cstrong\u003E-s \u0026lt;semicolon\u0026gt;\u003C\/strong\u003E : vous permet de d\u00e9finir le caract\u00e8re de s\u00e9paration dans le fichier de sortie. Par d\u00e9faut ; (point virgule).\u003C\/li\u003E\n \u003Cli\u003E\u003Cstrong\u003E-o \u0026lt;outputfile\u0026gt;\u003C\/strong\u003E : vous permet de d\u00e9finir le nom du fichier de sortie. Par d\u00e9faut, nom_fichier_entree.csv.\u003C\/li\u003E\n \u003Cli\u003E\u003Cstrong\u003E-i \u0026lt;inputfile\u0026gt;\u003C\/strong\u003E : seul param\u00e8tre obligatoire, vous permet de d\u00e9finir le fichier d\u0027entr\u00e9e du programme. Doit \u00eatre un fichier de type dbc.\u003C\/li\u003E\u003C\/ul\u003E\n\n\n\u003Cp\u003EEt voici le fichier en lui-m\u00eame. Si des soucis d\u0027antislashs viennent poser probl\u00e8me, cela vient du forum et il vous faudra alors les enlever manuellement.\u003C\/p\u003E\n\n\u003Cpre\u003E\u003Ccode class=\u0022language-python\u0022\u003E#!\/usr\/bin\/python\nimport struct\nimport sys, getopt\n\ndef main(filename, argv):\ninputfilename = \u0027\u0027\noutputfilename = \u0027\u0027\nglobal semicolon\nsemicolon = \u0027;\u0027\nglobal verbose\nverbose = False\nshowFormat = False\nhelper = filename+\u0022 [-hfv -s \u0026lt;semicolon\u0026gt; -o \u0026lt;outputfile\u0026gt;] -i \u0026lt;inputfile\u0026gt;\u0022+\u0022\\n\u0022\n\ntry:\nopts, args = getopt.getopt(argv,\u0022hfvs:o:i:\u0022,[\u0022semicolon=\u0022, \u0022ifile=\u0022, \u0022ofile=\u0022])\nexcept getopt.GetoptError:\nsys.stdout.write(helper)\nsys.exit(1)\nfor opt, arg in opts:\nif opt == \u0027-h\u0027:\nsys.stdout.write(helper)\nsys.exit()\nelif opt == \u0022-v\u0022:\nverbose = True\nelif opt in (\u0022-s\u0022, \u0022--semicolon\u0022):\nsemicolon = arg\nelif opt in (\u0022-i\u0022, \u0022--ifile\u0022):\ninputfilename = arg\nelif opt in (\u0022-o\u0022, \u0022--ofile\u0022):\noutputfilename = arg\nelif opt == \u0022-f\u0022:\nshowFormat = True\n\nif not inputfilename:\nsys.stdout.write(helper)\nsys.exit(1)\n\nif not outputfilename:\noutputfilename = inputfilename[:-4]+\u0027.csv\u0027\n\ninputfile = open(inputfilename, \u0022rb\u0022)\nglobal outputfile\noutputfile = open(outputfilename, \u0022w\u0022)\n\ntry:\nWDBC = inputfile.read(4)\nif WDBC != \u0022WDBC\u0022:\nsys.stderr.write(\u0022Not supported format\\n\u0022)\nsys.exit(2)\n\nheaders = readHeaders(inputfile)\ndatas = readDatas(inputfile, headers)\nskipBytes(inputfile, 1)\nstrings = readStrings(inputfile, headers)\ncolumns = identifyColumns(headers, datas, strings)\nif showFormat:\nsys.stdout.write(\u0022Headers : \u0022+str(headers)+\u0022\\n\u0022)\nsys.stdout.write(\u0022Format : \u0022+\u0027\u0027.join(columns)+\u0022\\n\u0022)\nsys.exit(0)\nwriteData(headers, datas, strings, columns)\nfinally:\ninputfile.close()\noutputfile.close()\n\ndef write(string):\noutputfile.write(string+\u0022\\n\u0022)\nif verbose:\nsys.stdout.write(string+\u0022\\n\u0022)\n\n\ndef writeData(headers, datas, strings, columns):\n\nfor rec in xrange(headers[\u0022nbrec\u0022]):\nrecstr = \u0022\u0022\nfor field in xrange(headers[\u0022nbfields\u0022]):\ncol = columns[field]\nif col == \u0027i\u0027:\nrecstr += str(struct.unpack(\u0027i\u0027, datas[rec][field])[0]) + semicolon\nelif col == \u0027f\u0027:\nrecstr += str(struct.unpack(\u0027f\u0027, datas[rec][field])[0]) + semicolon\nelif col == \u0027s\u0027:\ns = struct.unpack(\u0027i\u0027, datas[rec][field])[0]\nif not s:\nrecstr += \u0022NULL\u0022 + semicolon\nelse:\nrecstr = recstr + \u0027\u0022\u0027+str(strings[s])+\u0027\u0022\u0027 + semicolon\nwrite(recstr)\n\n\ndef identifyColumns(headers, datas,strings):\ncolumns = [\u0027i\u0027]*headers[\u0022nbfields\u0022]\nfor field in xrange(headers[\u0022nbfields\u0022]):\npossiblyAString = True\nfor rec in xrange(headers[\u0022nbrec\u0022]):\nvalue = struct.unpack(\u0027i\u0027, datas[rec][field])[0]\nif not value:\ncontinue\nif not (not(value \u0026amp; 0xFF800000) or (value \u0026amp; 0xFF800000 == 0xFF800000)):\ncolumns[field] = \u0027f\u0027\npossiblyAString = False\nbreak\nif value != 1 and value not in strings:\npossiblyAString = False\n\nif possiblyAString:\ncolumns[field] = \u0027s\u0027\nreturn columns\n\n\ndef readHeaders(inputfile):\nheaders = {}\nheaders[\u0022nbrec\u0022] = struct.unpack(\u0027i\u0027, inputfile.read(4))[0]\nheaders[\u0022nbfields\u0022] = struct.unpack(\u0027i\u0027, inputfile.read(4))[0]\nheaders[\u0022recsize\u0022] = struct.unpack(\u0027i\u0027, inputfile.read(4))[0]\nheaders[\u0022ssize\u0022] = struct.unpack(\u0027i\u0027, inputfile.read(4))[0]\nreturn headers\n\ndef readDatas(inputfile, headers):\ndata = []\nfor irec in xrange(headers[\u0022nbrec\u0022]):\nrec = []\nfor jfield in xrange(headers[\u0022nbfields\u0022]):\nbytes = inputfile.read(4)\nrec.append(bytes)\ndata.append(rec)\nreturn data\n\ndef skipBytes(inputfile, count):\ninputfile.read(count)\n\ndef readStrings(inputfile, headers):\nstrings = {}\ncounter = 1\nwhile counter \u0026lt; headers[\u0022ssize\u0022]:\ns = extractString(inputfile)\nstrings[counter] = s\ncounter += len(s)+1\nreturn strings\n\ndef extractString(inputfile):\ns = \u0022\u0022\ncar = inputfile.read(1)\nwhile ord(car) != 0:\ns = s+car\ncar = inputfile.read(1)\nreturn s\n\n\nif __name__ == \u0022__main__\u0022:\nmain(sys.argv[0], sys.argv[1:])\u003C\/code\u003E\u003Cscript async=\u0022\u0022 crossorigin=\u0022anonymous\u0022 data-hljs-style=\u0022github-gist\u0022 integrity=\u0022sha384-eud4nQrKZMwcYak7or3J5ZPJx1x4HRe8iTTHJy1SUVrDD+fP30Bo\/F8OSdQJpk8d\u0022 onload=\u0022hljsLoader.highlightBlocks(this.parentNode)\u0022 src=\u0022https:\/\/cdn.jsdelivr.net\/gh\/s9e\/hljs-loader@1.0.18\/loader.min.js\u0022\u003E\u003C\/script\u003E\u003C\/pre\u003E\n\n\u003Cp\u003EJ\u0027esp\u00e8re que ce tutoriel vous aura plu et que vous serez un peu plus curieux quant aux fichiers que vous utilisez (et pourquoi pas voir un tutoriel sur les fichiers utilis\u00e9s dans les maps et les vmaps par exemple ?) et que vous pourrez \u00e0 pr\u00e9sent d\u00e9velopper vos propres outils de lecture ou d\u0027\u00e9criture des DBCs au lieu d\u0027utiliser des logiciels existants, ferm\u00e9s et faisant la plupart du temps la moiti\u00e9 du travail que vous souhaitez \ud83d\ude09\u003C\/p\u003E\n\n\u003Cp\u003E\u003Cdel\u003EMerci \u00e0 vous de m\u0027avoir lu, comme toujours, je suis ouvert aux critiques constructives \ud83d\ude09\u003C\/del\u003E\u003C\/p\u003E","editedAt":"2021-01-09T12:11:02+00:00","canEdit":false,"canDelete":false,"canHide":false,"isApproved":true,"canApprove":false,"canFlag":false,"canLike":false},"relationships":{"discussion":{"data":{"type":"discussions","id":"34"}},"user":{"data":{"type":"users","id":"1"}},"editedUser":{"data":{"type":"users","id":"1"}},"likes":{"data":[]},"mentionedBy":{"data":[]}}},{"type":"users","id":"1","attributes":{"username":"Galathil","displayName":"Galathil","avatarUrl":"https:\/\/forum.open-wow.eu\/assets\/avatars\/6zjneQm6RzYl44hc.png","slug":"Galathil","joinTime":null,"discussionCount":33,"commentCount":35,"canEdit":false,"canDelete":false,"lastSeenAt":"2021-02-17T17:13:27+00:00","canSuspend":false},"relationships":{"groups":{"data":[{"type":"groups","id":"1"},{"type":"groups","id":"4"}]}}},{"type":"groups","id":"1","attributes":{"nameSingular":"Administrateur","namePlural":"Administrateurs","color":"#B72A2A","icon":"fas fa-wrench","isHidden":0}},{"type":"groups","id":"4","attributes":{"nameSingular":"Mod\u00e9rateur","namePlural":"Mod\u00e9rateurs","color":"#80349E","icon":"fas fa-bolt","isHidden":0}},{"type":"tags","id":"2","attributes":{"name":"Tutoriels","description":"","slug":"tutoriels","color":"#e74c3c","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":49,"position":2,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-02-18T21:14:17+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":45}}]}});
                flarum.core.app.bootExtensions(flarum.extensions);
                flarum.core.app.boot();
            } catch (e) {
                var error = document.getElementById('flarum-loading-error');
                error.innerHTML += document.getElementById('flarum-content').textContent;
                error.style.display = 'block';
                throw e;
            }
        </script>
</body>
</html>
