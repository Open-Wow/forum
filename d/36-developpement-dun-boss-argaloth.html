<!doctype html>
<html dir="ltr" lang="fr">
<head>
<meta charset="utf-8">
<title>D√©veloppement d&#039;un boss : Argaloth - Open WoW</title>
<link rel="stylesheet" href="../assets/forum-b586aac9.css">
<link rel="canonical" href="36-developpement-dun-boss-argaloth.html">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1">
<meta name="description" content="Le forum francophone d&#039;√©mulation WoW.">
<meta name="theme-color" content="#4D698E">
<link rel="shortcut icon" href="../assets/favicon-19klahq3.png">
<script src="https://www.recaptcha.net/recaptcha/api.js?hl=fr&render=explicit" async defer></script>
</head>
<body>
<div id="app" class="App">
<div id="app-navigation" class="App-navigation"></div>
<div id="drawer" class="App-drawer">
<header id="header" class="App-header">
<div id="header-navigation" class="Header-navigation"></div>
<div class="container">
<h1 class="Header-title">
<a href="https://forum.open-wow.eu" id="home-link">
<img src="../assets/logo-fje1vtuv.png" alt="Open WoW" class="Header-logo">
</a>
</h1>
<div id="header-primary" class="Header-primary"></div>
<div id="header-secondary" class="Header-secondary"></div>
</div>
</header>
</div>
<main class="App-content">
<div id="content"></div>
<div id="flarum-loading" style="display: none">
Chargement‚Ä¶
</div>
<noscript>
    <div class="Alert">
        <div class="container">
            Ce site est optimis√© pour √™tre consult√© depuis un navigateur moderne dans lequel JavaScript est activ√©.
        </div>
    </div>
</noscript>
<div id="flarum-loading-error" style="display: none">
<div class="Alert">
<div class="container">
Une erreur est survenue lors de la tentative de chargement de la version compl√®te de ce site. Veuillez purger le cache de votre navigateur et rafra√Æchir cette page pour tenter de corriger cette erreur.
</div>
</div>
</div>
<noscript id="flarum-content">
    <div class="container">
    <h2>D√©veloppement d&#039;un boss : Argaloth</h2>

    <div>
                    <div>
                                <h3>Galathil</h3>
                <div class="Post-body">
                    <p><strong>Important :</strong> Ce tutoriel a √©t√© r√©dig√© par Nobodie pour le site wow-emu.fr. Je le recopie ici √† l'identique, Il se peut que certaines informations soient obsol√®tes √† ce jour. Bonne lecture !</p>

<h1>D√©veloppement d'un boss : Argaloth</h1>
<p>Bonjour,</p>

<p>aujourd'hui nous allons voir ensemble, en pratique, comment scripter un boss. Pour notre exemple, nous allons choisir un boss dont le script est simple : Argaloth. Il s'agit du premier boss du Bastion de Baradin, premier donjon de l'extension Cataclysm. De plus, celui-ci a d√©j√† √©t√© cod√© quasiment parfaitement par Trinity et nous pouvons donc nous en servir comme base d'apprentissage. Entrons d√®s √† pr√©sent dans le vif du sujet.</p>

<p>Le code complet de Trinity (attention, quelques modifications sont apport√©es par mes soins dans ce tutoriel) est visible √† <a href="https://github.com/TrinityCore/TrinityCore/blob/master/src/server/scripts/EasternKingdoms/BaradinHold/boss_pit_lord_argaloth.cpp" rel=" nofollow ugc">cette adresse</a>.</p>

<h2>1) La recherche d'informations</h2>

<p>Le d√©veloppement de boss ressemble √† ce qu'on appelle de la programmation √©v√©nementielle. On d√©finit un certain nombre d'√©v√©nements qui s'ex√©cutent, et √† chacun de ces √©v√©nements on associe une fonction qui contient le code charg√©e de g√©rer l'√©v√©nement. La priorit√©, lorsque l'on souhaite d√©velopper un boss, c'est donc de trouver le maximum d'informations √† son sujet.</p>

<p>Pour ce faire, de nombreux sites sont √† votre disposition, tels que wowhead, judgehype ou m√™me youtube pour visualiser des vid√©os du combat sur officiel. Pour ma part, j'utilise principalement wowhead et youtube.</p>

<p>Pour ce qui est de wowhead, n'h√©sitez pas √† regarder les pages dans plusieurs langues. Si on compare la version <a href="https://fr.wowhead.com/npc=47120/argaloth" rel=" nofollow ugc">Argaloth</a> et <a href="https://www.wowhead.com/npc=47120/argaloth" rel=" nofollow ugc">Argaloth</a> d'argaloth, on constate que la version fran√ßaise est beaucoup plus riche et contient une description de l'ensemble de la strat√©gie √† appliquer contre ce boss. C'est donc la page fran√ßaise qui va nous servir de r√©f√©rence.</p>

<p>Apr√®s lecture de ces paragraphes et visualisation de vid√©os sur Youtube, on parvient √† en extraire 4 √©v√©nements majeurs :</p>

 <ul><li>Lancement de <a href="https://fr.wowhead.com/spell=88942/attaque-m%C3%A9t%C3%A9orique" rel=" nofollow ugc">Attaque m√©t√©orique</a> environ 15 secondes apr√®s le d√©but du combat, puis toutes les 15 √† 20 secondes.</li>
 <li>Lancement de <a href="https://fr.wowhead.com/spell=88954/t%C3%A9n%C3%A8bres-consumantes" rel=" nofollow ugc">T√©n√®bres consumantes</a> environ 20 secondes apr√®s le d√©but du combat, puis toutes les 20 √† 25 secondes.</li>
 <li>Lancement de <a href="https://fr.wowhead.com/spell=88972/temp%C3%AAte-de-feu-gangren%C3%A9e" rel=" nofollow ugc">Temp√™te de feu gangren√©e</a> lorsque la vie du boss atteint 66% puis 33% de vie.</li>
 <li>Lancement de <a href="https://fr.wowhead.com/spell=47008/berserk" rel=" nofollow ugc">Berserk</a> au bout de 5 minutes de combat.</li></ul>

<p>Nous avons identifi√© tous nos √©v√©nements, il est temps de cr√©er le fichier cpp qui va contenir le script du boss !</p>

<h2>2) Ou cr√©er un script pour le boss et comment le compiler</h2>


<p>L'ensemble des fichiers script du serveur se situent dans le sous-dossier script situ√© dans l'arborescence suivante : <code>src/server/scripts/</code>.</p>

<p>Les scripts sont majoritairement rang√©s dans des sous-dossiers de la forme <code>Continent/InstanceName/bossName.cpp</code>. N'h√©sitez pas √† garder cette habitude pour maintenir un dossier de scripts propre.</p>

<p>Les dossiers sont bien constitu√©s et vous trouverez donc (ou cr√©erez) le fichier sous le dossier <code>EasternKingdoms/BaradinHold</code> et aura pour nom <code>boss_pit_lord_argaloth.cpp</code>. On aurait √©galement pu l'appeler boss_argaloth, √©videmment, mais puisque Trinity l'a appel√© comme √ßa, autant le garder sous la m√™me forme üòâ</p>

<p>La chose suivante √† effectuer est d'integrer ce nouveau fichier aux fichiers de configuration que l'on appelle les fichiers <code>CMakeLists.txt</code>. Pour cela, ouvrez le fichier dans l'arborescence suivante : <code>src/server/scripts/EasternKingdoms/CMakeLists.txt</code> et ajoutez (si elle n'existe pas encore) la ligne suivante :</p>
<pre><code>EasternKingdoms/BaradinHold/boss_pit_lord_argaloth.cpp</code><script async="" crossorigin="anonymous" data-hljs-style="github-gist" integrity="sha384-eud4nQrKZMwcYak7or3J5ZPJx1x4HRe8iTTHJy1SUVrDD+fP30Bo/F8OSdQJpk8d" onload="hljsLoader.highlightBlocks(this.parentNode)" src="https://cdn.jsdelivr.net/gh/s9e/hljs-loader@1.0.18/loader.min.js"></script></pre>

<p>En faisant cela, votre fichier sera d√©sormais integr√© √† votre projet et sera compil√© avec vos autres fichiers.</p>

<p>Maintenant que le fichier est cr√©√©, il va nous falloir le remplir avec une classe qui va nous permettre de scripter le boss. Voici le code g√©n√©ral que nous allons y int√©grer :</p>

<pre><code class="language-cpp">#include "ScriptMgr.h"
#include "ScriptedCreature.h"

class boss_pit_lord_argaloth : public CreatureScript
{
public:
boss_pit_lord_argaloth() : CreatureScript("boss_pit_lord_argaloth") { }

struct boss_pit_lord_argalothAI : public ScriptedAI
{
boss_pit_lord_argalothAI(Creature* creature) : ScriptedAI(creature) { }

};

CreatureAI* GetAI(Creature* creature) const override
{
return GetBaradinHoldAI&lt;boss_pit_lord_argalothAI&gt;(creature);
}
};

void AddSC_boss_pit_lord_argaloth()
{
new boss_pit_lord_argaloth();
}</code><script async="" crossorigin="anonymous" data-hljs-style="github-gist" integrity="sha384-eud4nQrKZMwcYak7or3J5ZPJx1x4HRe8iTTHJy1SUVrDD+fP30Bo/F8OSdQJpk8d" onload="hljsLoader.highlightBlocks(this.parentNode)" src="https://cdn.jsdelivr.net/gh/s9e/hljs-loader@1.0.18/loader.min.js"></script></pre>

<p>ce script minimal contient 3 choses primordiales :</p>
 <ul><li>Premi√®rement, la classe <strong>boss_pit_lord_argaloth</strong> h√©rite de CreatureScript (d√©finie dans <code>src/server/game/Scripting/ScriptMgr.h)</code>. La d√©finition du constructeur de la classe est importante car il appelle le constructeur de CreatureScript qui prend en param√®tre une cha√Æne de caract√®re (ici "<strong>boss_pit_lord_argaloth</strong>" qui sera utilis√© plus tard dans la base de donn√©es pour relier le creature_template d'argaloth √† ce script). C'est donc cette ligne qui vous permet de d√©finir le "nom" du script.</li>
<li>Deuxi√®mement, cette classe poss√®de une structure <strong>boss_pit_lord_argalothAI</strong> qui h√©rite de ScriptedAI (AI signifiant <strong>A</strong>rtificial <strong>I</strong>ntelligency). C'est dans cette structure que nous coderons la totalit√© de notre boss par la suite (attention donc √† bien √©crire le code futur √† l'int√©rieur des accolades de cette structure). Il y a √©galement une fonction GetAI qui est une fonction surcharg√©e (comme on le voit avec la constante override √† la fin de son prototype) qui sert √† relier l'Intelligence Artificielle (d√©finie dans la structure) √† notre classe <strong>boss_pit_lord_argaloth</strong>. Il est important de garder un prototype identique √† celui pr√©sent√© ici, sinon l'appel √† la fonction ne se fera pas et votre cr√©ature ne fera absolument rien.</li>
 <li>Enfin, il y a une ultime fonction d√©finie tout en bas du script qui va permettre de relier notre CreatureScript aux fonctions de chargement des scripts (que nous allons voir juste apr√®s). Par convention, toutes ces fonctions commencent par le pr√©fixe AddSC (pour Add Script, en anglais) et cr√©√©ent (via l'op√©rateur new une nouvelle occurence de notre script <strong>boss_pit_lord_argaloth</strong>.</li></ul>

<p>Certains auront peut-√™tre remarqu√© que notre structure boss_pit_lord_argalothAI h√©rite de ScriptedAI tandis que le script officiel de Trinity h√©rite de BossAI. Pour des raisons de simplification de ce tutoriel, j'ai choisi de ne pas utiliser BossAI car elle n√©cessite un script d'instance qui ne rentre pas dans le cadre de ce tutoriel. N√©anmoins, sachez simplement qu'un script d'instance permet de sauvegarder l'√©tat de l'instance (boss tu√©s, principalement) afin de pouvoir interagir avec elle et effectuer des modifications sur l'instance (par exemple g√©rer l'ouverture de portes menant √† la suite de l'instance).</p>

<p>Si vous avez eu du mal √† comprendre certains des termes utilis√©s juste au dessus (h√©ritage, surcharge, constructeur ...) je vous invite grandement √† stopper la lecture de ce tutoriel et √† <del>partir √©lever des ch√®vres en Ari√®ge</del> (re)lire un cours sur la programmation orient√©e objet avec C++ <a href="https://openclassrooms.com/fr/courses/1894236-programmez-avec-le-langage-c" rel=" nofollow ugc">ICI</a> !. Vous ne pourrez pas suivre le reste du tutorial sans cela.</p>

<p>Si vous compilez votre projet dans l'√©tat actuel des choses, votre script ne fera rien car non seulement il ne poss√®de encore aucun code sp√©cifique au boss, mais aussi et surtout parce que aucune syst√®me interne au core n'appelle la fonction AddSC_boss_pit_lord_argaloth() que nous avons d√©fini juste avant. Pour ce faire, nous allons ouvrir le fichier suivant dans l'arborescence <code>src/server/game/Scripting/ScriptLoader.cpp</code> et ajoutez deux lignes qui feront le lien avec notre script :</p>

<p>Premi√®rement la d√©finition de notre fonction :</p>
<pre><code class="language-cpp">void AddSC_boss_pit_lord_argaloth();</code><script async="" crossorigin="anonymous" data-hljs-style="github-gist" integrity="sha384-eud4nQrKZMwcYak7or3J5ZPJx1x4HRe8iTTHJy1SUVrDD+fP30Bo/F8OSdQJpk8d" onload="hljsLoader.highlightBlocks(this.parentNode)" src="https://cdn.jsdelivr.net/gh/s9e/hljs-loader@1.0.18/loader.min.js"></script></pre>

<p>Puis l'appel √† la fonction dans la fonction <strong>void AddEasternKingdomsScripts():</strong></p>
<pre><code class="language-cpp">AddSC_boss_pit_lord_argaloth();</code><script async="" crossorigin="anonymous" data-hljs-style="github-gist" integrity="sha384-eud4nQrKZMwcYak7or3J5ZPJx1x4HRe8iTTHJy1SUVrDD+fP30Bo/F8OSdQJpk8d" onload="hljsLoader.highlightBlocks(this.parentNode)" src="https://cdn.jsdelivr.net/gh/s9e/hljs-loader@1.0.18/loader.min.js"></script></pre>

<p>Je vous laisse prendre exemple sur le fichier pour trouver ou √©crire ces deux lignes üòâ</p>

<p>Voil√† qui est fait, l'ultime √©tape reste √† modifier la DB pour associer notre creature_template d'Argaloth (entry #47120) au ScriptName d√©fini un peu plus t√¥t : <strong>boss_pit_lord_argaloth</strong>.</p>


<p>Une fois que tout ceci est fait, notre script est pr√™t √† coder !</p>


<h2>3) D√©finition des √©num√©rations n√©cessaires √† notre boss</h2>

<p>Par convention, l'ensemble des scripts sont √©crits en langue anglaise. Aussi je ne saurais que trop vous inviter √† vous adapter √† la langue de Shakespeare üòâ</p>

<p>Nous l'avons dit tout √† l'heure, il y a en tout 4 spells √† lancer. Nous allons donc commencer simplement en d√©finissant une √©num√©ration contenant l'ensemble de ces sorts (afin d'avoir un script bien lisible par la suite). En dehors de toute fonction/classe, il suffit d'√©crire la chose suivante :</p>

<pre><code class="language-cpp">enum Spells
{
SPELL_METEOR_SLASH = 88942,
SPELL_CONSUMING_DARKNESS = 88954,
SPELL_FEL_FIRESTORM = 88972,
SPELL_BERSERK = 47008
};</code><script async="" crossorigin="anonymous" data-hljs-style="github-gist" integrity="sha384-eud4nQrKZMwcYak7or3J5ZPJx1x4HRe8iTTHJy1SUVrDD+fP30Bo/F8OSdQJpk8d" onload="hljsLoader.highlightBlocks(this.parentNode)" src="https://cdn.jsdelivr.net/gh/s9e/hljs-loader@1.0.18/loader.min.js"></script></pre>

<p>Les ID des sorts sont disponibles via wowhead.</p>

<p>Nous allons √©galement cr√©er une seconde √©num√©ration correspondant √† nos √©v√©nements. Comme on l'a dit, l'√©v√©nement d√©clenchant l'envoi du sort <a href="https://fr.wowhead.com/spell=88972/temp%C3%AAte-de-feu-gangren%C3%A9e" rel=" nofollow ugc">Temp√™te de feu gangren√©e</a> ne sera pas fait. Il y a donc seulement 3 √©v√©nements √† d√©finir :</p>

<pre><code class="language-cpp">enum Events
{
EVENT_METEOR_SLASH = 1,
EVENT_CONSUMING_DARKNESS = 2,
EVENT_BERSERK = 3
};</code><script async="" crossorigin="anonymous" data-hljs-style="github-gist" integrity="sha384-eud4nQrKZMwcYak7or3J5ZPJx1x4HRe8iTTHJy1SUVrDD+fP30Bo/F8OSdQJpk8d" onload="hljsLoader.highlightBlocks(this.parentNode)" src="https://cdn.jsdelivr.net/gh/s9e/hljs-loader@1.0.18/loader.min.js"></script></pre>

<p>Attention, si la valeur num√©rique d√©finissant un √©v√©nement importe peu, il est par contre <strong>primordial</strong> que le premier √©v√©nement d√©fini commence avec l'ID 1 et non 0. Sinon, celui-ci ne sera pas ex√©cut√© ensuite lorsqu'on arrivera √† la gestion des √©v√©nements.</p>

<p>voil√† qui est tout pour la d√©finition des √©num√©rations n√©cessaires √† notre boss</p>

<h2>4) Surcharge des fonctions du script</h2>

<p>Nous allons reparler ici des fonctions surcharg√©es. En effect, l'ensemble du syst√®me de script repose sur cette notion de la programmation orient√©e objet. L'intelligence artificielle de notre boss h√©rite d'une structure d√©finie par le core. Cette structure poss√®de diff√©rentes fonctions appel√©es √† des moments cl√© de l'ex√©cution d'un boss. Par exemple, la fonction <strong>EnterCombat</strong> est appel√©e lorsque le groupe de joueurs entre en combat avec le boss. la fonction <strong>DamageTaken</strong> est appel√©e ... chaque fois que le boss prend des d√©gats. Et la fonction <strong>UpdateAI</strong> est appel√©e √† chaque tick d'horloge du serveur. Ces trois fonctions nous seront d'ailleurs n√©cessaires pour coder notre boss. Pour rappel, ces fonctions sont √† d√©finir √† l'int√©rieur de notre structure h√©rit√©e de ScriptedAI. Ne vous trompez pas !</p>

<p>Faites tr√®s attention au prototype de votre fonction. Si celle-ci ne correspond pas exactement au prototype de la fonction m√®re, c'est la fonction m√®re qui sera appel√©e en lieu et place de la votre, et votre boss ne fera donc que la moiti√© des actions que vous lui auriez programm√©. Cette erreur est souvent commise par m√©garde et peut ensuite faire l'objet de nombreuses heures de recherches.</p>

<h3>a) Surcharge de EnterCombat</h3>

<p>Nous allons donc commencer par EnterCombat, qui est appel√© d√®s lors que le combat avec le boss commence. Voici le code de la fonction sur Trinity :</p>

<pre><code class="language-cpp">void EnterCombat(Unit* /*who*/) override
{
_EnterCombat();
//instance-&gt;SendEncounterUnit(ENCOUNTER_FRAME_ENGAGE, me);
events.ScheduleEvent(EVENT_METEOR_SLASH, urand(10 * IN_MILLISECONDS, 20 * IN_MILLISECONDS));
events.ScheduleEvent(EVENT_CONSUMING_DARKNESS, urand(20 * IN_MILLISECONDS, 25 * IN_MILLISECONDS));
events.ScheduleEvent(EVENT_BERSERK, 5 * MINUTE * IN_MILLISECONDS);
}</code><script async="" crossorigin="anonymous" data-hljs-style="github-gist" integrity="sha384-eud4nQrKZMwcYak7or3J5ZPJx1x4HRe8iTTHJy1SUVrDD+fP30Bo/F8OSdQJpk8d" onload="hljsLoader.highlightBlocks(this.parentNode)" src="https://cdn.jsdelivr.net/gh/s9e/hljs-loader@1.0.18/loader.min.js"></script></pre>

<p>On peut voir qu'elle fait 5 lignes que nous allons d√©velopper juste apr√®s :</p>
 <ul><li><strong>_EnterCombat();</strong> : Il s'agit de l'appel √† une sous fonction EnterCombat d√©finie dans la classe m√®re. Elle permet de ne pas avoir √† initialiser un certain nombre de choses dans notre code.</li>
 <li><strong>instance-&gt;SendEncounterUnit(ENCOUNTER_FRAME_ENGAGE, me)</strong>; : Cette ligne (que j'ai volontairement comment√©e) sert √† interagir avec notre √©ventuel script d'instance afin de pouvoir sauvegarder son √©tat d'avancement.</li>
 <li><strong>events.ScheduleEvent(EVENT_METEOR_SLASH, urand(10 * IN_MILLISECONDS, 20 * IN_MILLISECONDS));</strong> : Cette ligne nous permet de cr√©er un premier √©v√©nement √† partir de notre √©num√©ration. On lui attribue un temps d'ex√©cution entre 10 et 20 secondes.</li>
 <li><strong>events.ScheduleEvent(EVENT_CONSUMING_DARKNESS, urand(20 * IN_MILLISECONDS, 25 * IN_MILLISECONDS));</strong> : Cette ligne nous permet de cr√©er un second √©v√©nement √† partir de notre √©num√©ration. On lui attribue un temps d'ex√©cution al√©atoire entre 20 et 25 secondes.</li>
 <li><strong>events.ScheduleEvent(EVENT_BERSERK, 5 * MINUTE * IN_MILLISECONDS);</strong> : Cette ligne nous permet de cr√©er un troisi√®me √©v√©nement √† partir de notre √©num√©ration. On lui attribue un temps d'ex√©cution de 5 minutes.</li></ul>

<p>Il faut bien saisir que nous ne faison ici qu'enregistrer les trois √©v√©nements. Il seront trait√©s par la suite.</p>

<h3>b) Surcharge de EnterEvadeMode</h3>

<p>Voici le code source de cette fonction :</p> 
<pre><code class="language-cpp">void EnterEvadeMode() override
{
me-&gt;GetMotionMaster()-&gt;MoveTargetedHome();
//instance-&gt;SendEncounterUnit(ENCOUNTER_FRAME_DISENGAGE, me);
_DespawnAtEvade();
}</code><script async="" crossorigin="anonymous" data-hljs-style="github-gist" integrity="sha384-eud4nQrKZMwcYak7or3J5ZPJx1x4HRe8iTTHJy1SUVrDD+fP30Bo/F8OSdQJpk8d" onload="hljsLoader.highlightBlocks(this.parentNode)" src="https://cdn.jsdelivr.net/gh/s9e/hljs-loader@1.0.18/loader.min.js"></script></pre>

<p>Il n'y a pas grand chose √† expliquer, la premi√®re ligne g√©n√®re un mouvement de la cr√©ature (identifi√©e par le pointeur interne me) vers sa position initiale. La seconde ligne est √† nouveau comment√©e car inutile dans ce tutoriel, et la troisi√®me fait appel √† la fonction interne g√©rant le despawn de la cr√©ature.</p>

<h3>c) Surcharge de JustDied</h3>
<pre><code class="language-cpp">void JustDied(Unit* /*killer*/) override
{
_JustDied();
//instance-&gt;SendEncounterUnit(ENCOUNTER_FRAME_DISENGAGE, me);
}</code><script async="" crossorigin="anonymous" data-hljs-style="github-gist" integrity="sha384-eud4nQrKZMwcYak7or3J5ZPJx1x4HRe8iTTHJy1SUVrDD+fP30Bo/F8OSdQJpk8d" onload="hljsLoader.highlightBlocks(this.parentNode)" src="https://cdn.jsdelivr.net/gh/s9e/hljs-loader@1.0.18/loader.min.js"></script></pre>

<p>Rien de particulier √† expliquer ici.</p>

<h3>d) Surcharge de UpdateAI</h3>

<p>Ici vient la principale fonction, et la plus int√©ressante, dont voici le code :</p>
<pre><code class="language-cpp">void UpdateAI(uint32 diff) override
{
if (!UpdateVictim())
return;

events.Update(diff);

if (me-&gt;HasUnitState(UNIT_STATE_CASTING))
return;

while (uint32 eventId = events.ExecuteEvent())
{
switch (eventId)
{
case EVENT_METEOR_SLASH:
DoCastAOE(SPELL_METEOR_SLASH);
events.ScheduleEvent(EVENT_METEOR_SLASH, urand(15 * IN_MILLISECONDS, 20 * IN_MILLISECONDS));
break;
case EVENT_CONSUMING_DARKNESS:
DoCastAOE(SPELL_CONSUMING_DARKNESS, true);
events.ScheduleEvent(EVENT_CONSUMING_DARKNESS, urand(20 * IN_MILLISECONDS, 25 * IN_MILLISECONDS));
break;
case EVENT_BERSERK:
DoCast(me, SPELL_BERSERK, true);
break;
default:
break;
}
}

DoMeleeAttackIfReady();
}</code><script async="" crossorigin="anonymous" data-hljs-style="github-gist" integrity="sha384-eud4nQrKZMwcYak7or3J5ZPJx1x4HRe8iTTHJy1SUVrDD+fP30Bo/F8OSdQJpk8d" onload="hljsLoader.highlightBlocks(this.parentNode)" src="https://cdn.jsdelivr.net/gh/s9e/hljs-loader@1.0.18/loader.min.js"></script></pre>

<p>Cette fonction est divis√©e en plusieurs parties que nous allons voir d√®s √† pr√©sent :</p>
 <ul><li>Premi√®rement, on v√©rifie qu'on poss√®de bien une victime potentielle. S'il n'y en a aucune (et que donc tout le monde est mort) il n'y a plus aucune raison de faire s'ex√©cuter le boss. On quitte donc via return.</li>
 <li>Ensuite, on met √† jour les √©v√©nements via la proc√©dure Update. Celle-ci prend en parama√®tre la variable diff qui est en fait le temps (en millisecondes) depuis le pr√©c√©dent appel √† UpdateAI. Cella va donc mettre √† jour les timers de tous les √©v√©nements d√©finis via la fonction EnterCombat vue pr√©c√©demment.</li>
 <li>Puis, si le boss est d√©j√† en train de lancer un sort, il faut le laisser poursuivre son cast. Nous quittons donc notre boucle.</li>
 <li>Enfin arrive une boucle while qui peut se traduire litt√©ralement par "Tant qu'il reste des √©v√©nements √† ex√©cuter". C'est √† cause de ce while que nos √©v√©nements auparavant d√©finis dans l'√©num√©ration devaient √™tre diff√©rents de 0, car sinon cette condition serait consid√©r√©e comme fausse et l'on sortirait alors de la boucle sans jamais entrer dedans. Chacun des √©v√©nements poss√®de alors sont propre code. On peut voir qu'il y a en g√©n√©ral deux lignes :
    <ul><li>Le lancement du spell correspondant (lui aussi indiqu√© pr√©c√©demment via une √©num√©ration). Ici ce sont des AoE, mais il pourrait y avoir d'autres syst√®mes pour r√©cup√©rer une cible al√©atoire ou le tank du groupe, par exemple.</li>
    <li>L'appel √† nouveau au ScheduleEvent qui permet de red√©finir le prochain temps permettant de relancer le sort ensuite.<br>
 Dals le cas de Berserk, √©videmment, il n'y a pas de ScheduleEvent du fait que si le groupe ne parvient pas √† tuer le boss en moins de 5 minutes, celui-ci entre en mode Berserk jusqu'√† la fin du combat.</li></ul></li>
 <li>Finalement, on appelle la fonction <strong>DoMeleeAttackIfReady()</strong> qui est en g√©n√©ral la derni√®re appel√©e dans UpdateAI et qui permet au boss de tapper au corps √† corps si son √©tat le lui permet (c'est-√†-dire s'il n'est pas en train de caster un sort, s'il n'est pas entrav√©, etc).</li></ul>

<h3>5) Pour aller plus loin</h3>

<p>Comme nous l'avons vu ensemble, il reste un sort qui n'a pas √©t√© lanc√©. Il s'agit de <a href="http://fr.wowhead.com/spell=88972" rel=" nofollow ugc">Temp√™te de feu gangren√©e</a>. Pour cela, il vous faut surcharger la fonction DamageTaken afin d'envoyer ce sort <strong>exactement</strong> lorsque le boss passe sous la barre des 66% puis des 33%.</p>

<p>Le code propos√© par trinity est faux, la condition est vraie d√®s lors que le boss passe sous la barre des 66% de vie et enverra d√®s lors la temp√™te √† chaque appel √† DamageTaken. A vous de changer son comportement en integrant par exemple un bool√©en permettant de connaitre l'ancien √©tat du boss.</p>

<p>Enfin, nous avons ici trait√© l'aspect purement technique du boss, et ne nous sommes donc pas pench√©s sur le script des sorts en eux-m√™mes. Il est probable que ceux-ci puissent n√©cessiter des modifications afin de correspondre au syst√®me officiel. Nous ne traiterons pas dans ce tutoriel de comment scripter des sorts, mais cela fera peut-√™tre l'objet d'un futur tutoriel. Libre √† vous √©galement de vous renseigner de votre c√¥t√© pour savoir comment faire üòâ</p>

<h3>6) Conclusion</h3>
<p>Voil√† que se termine ce tutoriel. Apr√®s correction des erreurs de compilation, votre script devrait pouvoir s'ex√©cuter et vous aurez alors devant vous un boss Argaloth pr√™t √† en d√©coudre !</p>

<p>Gardez √† l'esprit que ce boss est parmi les plus simples de Wow et que, l√† ou ce script fait moins d'une centaine de lignes, d'autres en font pr√®s de 6000 üòÄ Pr√©parez-vous donc √† souffrir, mais n'oubliez pas pour autant que tout est r√©alisable et que seule votre volont√© vous permettra d'arriver √† vos fins. Alors n'abandonnez pas √† la moindre difficult√© et poursuivez vos efforts !</p>

<p><del>Je reste disponible pour toutes questions/am√©liorations propos√©es.</del></p>
                </div>
            </div>

            <hr>
            </div>

    
    </div>

</noscript>
<div class="App-composer">
<div class="container">
<div id="composer"></div>
</div>
</div>
</main>
</div>
<div id="modal"></div>
<div id="alerts"></div>
<script>
            document.getElementById('flarum-loading').style.display = 'block';
            var flarum = {extensions: {}};
        </script>
<script src="../assets/forum-2c55cc91.js"></script>
<script src="../assets/forum-fr-b93474b7.js"></script>
<script>
            document.getElementById('flarum-loading').style.display = 'none';

            try {
                flarum.core.app.load({"resources":[{"type":"forums","id":"1","attributes":{"title":"Open WoW","description":"Le forum francophone d\u0027\u00e9mulation WoW.","showLanguageSelector":true,"baseUrl":"https:\/\/forum.open-wow.eu","basePath":"","debug":false,"apiUrl":"https:\/\/forum.open-wow.eu\/api","welcomeTitle":"Bienvene sur Open WoW","welcomeMessage":"Le forum francophone d\u0027\u00e9mulation WoW.","themePrimaryColor":"#4D698E","themeSecondaryColor":"#4D698E","logoUrl":"https:\/\/forum.open-wow.eu\/assets\/logo-fje1vtuv.png","faviconUrl":"https:\/\/forum.open-wow.eu\/assets\/favicon-19klahq3.png","headerHtml":null,"footerHtml":null,"allowSignUp":true,"defaultRoute":"\/all","canViewDiscussions":true,"canStartDiscussion":true,"canViewUserList":false,"canViewFlags":false,"guidelinesUrl":null,"minPrimaryTags":"1","maxPrimaryTags":"1","minSecondaryTags":"0","maxSecondaryTags":"99","canSeeUserDirectoryLink":false,"userDirectoryDefaultSort":"username_az","darkMode":true,"categories.keepTagsNav":false,"categories.fullPageDesktop":false,"categories.compactMobile":false,"categories.parentRemoveIcon":false,"categories.parentRemoveDescription":false,"categories.parentRemoveStats":false,"categories.parentRemoveLastDiscussion":false,"categories.childBareIcon":false,"emojioneAreaEnableSearch":true,"emojioneAreaEnableRecent":true,"emojioneAreaEnableTones":true,"emojioneAreaFiltersPositionBottom":false,"emojioneAreaSearchPositionBottom":false,"emojioneAreaHideFlarumButton":true},"relationships":{"groups":{"data":[{"type":"groups","id":"1"},{"type":"groups","id":"2"},{"type":"groups","id":"3"},{"type":"groups","id":"4"}]},"tags":{"data":[{"type":"tags","id":"1"},{"type":"tags","id":"2"},{"type":"tags","id":"3"},{"type":"tags","id":"9"},{"type":"tags","id":"10"},{"type":"tags","id":"11"},{"type":"tags","id":"12"},{"type":"tags","id":"13"},{"type":"tags","id":"14"},{"type":"tags","id":"15"},{"type":"tags","id":"16"},{"type":"tags","id":"17"},{"type":"tags","id":"18"},{"type":"tags","id":"19"},{"type":"tags","id":"20"},{"type":"tags","id":"21"},{"type":"tags","id":"23"},{"type":"tags","id":"24"},{"type":"tags","id":"25"},{"type":"tags","id":"26"},{"type":"tags","id":"27"},{"type":"tags","id":"28"},{"type":"tags","id":"29"},{"type":"tags","id":"30"},{"type":"tags","id":"31"},{"type":"tags","id":"32"},{"type":"tags","id":"33"},{"type":"tags","id":"34"},{"type":"tags","id":"35"},{"type":"tags","id":"36"},{"type":"tags","id":"37"},{"type":"tags","id":"38"},{"type":"tags","id":"39"},{"type":"tags","id":"40"},{"type":"tags","id":"42"},{"type":"tags","id":"43"}]}}},{"type":"groups","id":"1","attributes":{"nameSingular":"Administrateur","namePlural":"Administrateurs","color":"#B72A2A","icon":"fas fa-wrench","isHidden":0}},{"type":"groups","id":"2","attributes":{"nameSingular":"Invit\u00e9","namePlural":"Invit\u00e9s","color":null,"icon":null,"isHidden":0}},{"type":"groups","id":"3","attributes":{"nameSingular":"Membre","namePlural":"Membres","color":null,"icon":null,"isHidden":0}},{"type":"groups","id":"4","attributes":{"nameSingular":"Mod\u00e9rateur","namePlural":"Mod\u00e9rateurs","color":"#80349E","icon":"fas fa-bolt","isHidden":0}},{"type":"tags","id":"1","attributes":{"name":"General","description":null,"slug":"general","color":"#888","backgroundUrl":null,"backgroundMode":null,"icon":null,"discussionCount":0,"position":0,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":null,"canStartDiscussion":false,"canAddToDiscussion":false,"postCount":0}},{"type":"tags","id":"2","attributes":{"name":"Tutoriels","description":"","slug":"tutoriels","color":"#e74c3c","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":56,"position":2,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-02-18T21:50:53+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":52},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"88"}}}},{"type":"tags","id":"3","attributes":{"name":"Partages","description":"","slug":"partagess","color":"#e74c3c","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":41,"position":3,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-02-18T21:49:19+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":40},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"85"}}}},{"type":"tags","id":"9","attributes":{"name":"Support","description":"","slug":"support","color":"#e74c3c","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":1,"position":4,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-01-04T17:18:38+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":8},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"28"}}}},{"type":"tags","id":"10","attributes":{"name":"C++","description":"","slug":"tuto-cpp","color":"#e74c3c","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":11,"position":1,"defaultSort":null,"isChild":true,"isHidden":false,"lastPostedAt":"2021-02-18T21:50:27+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":9},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"87"}},"parent":{"data":{"type":"tags","id":"2"}}}},{"type":"tags","id":"11","attributes":{"name":"Lua","description":"","slug":"tuto-lua","color":"#e74c3c","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":8,"position":2,"defaultSort":null,"isChild":true,"isHidden":false,"lastPostedAt":"2021-02-18T21:25:53+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":8},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"74"}},"parent":{"data":{"type":"tags","id":"2"}}}},{"type":"tags","id":"12","attributes":{"name":"SQL","description":"","slug":"tuto-sql","color":"#e74c3c","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":12,"position":4,"defaultSort":null,"isChild":true,"isHidden":false,"lastPostedAt":"2021-02-18T21:50:53+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":12},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"88"}},"parent":{"data":{"type":"tags","id":"2"}}}},{"type":"tags","id":"13","attributes":{"name":"Vanilla","description":"","slug":"vanilla","color":"#f39c12","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":12,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-01-07T13:34:50+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":13},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"31"}}}},{"type":"tags","id":"14","attributes":{"name":"The Burning Crusade","description":"","slug":"the-burning-crusade","color":"#f39c12","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":13,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-02-12T15:47:42+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":14},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"56"}}}},{"type":"tags","id":"15","attributes":{"name":"Wrath of the Lich King","description":"","slug":"wrath-of-the-lich-king","color":"#f39c12","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":24,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-02-18T21:04:05+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":27},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"57"}}}},{"type":"tags","id":"16","attributes":{"name":"Cataclysm","description":"","slug":"cataclysm","color":"#f39c12","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":3,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-02-12T15:47:42+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":3},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"56"}}}},{"type":"tags","id":"17","attributes":{"name":"Mists of Pandaria","description":"","slug":"mists-of-pandaria","color":"#f39c12","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":2,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-02-12T15:47:42+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":2},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"56"}}}},{"type":"tags","id":"18","attributes":{"name":"Warlords of Draenor","description":"","slug":"warlords-of-draenor","color":"#f39c12","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":2,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-02-12T15:47:42+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":2},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"56"}}}},{"type":"tags","id":"19","attributes":{"name":"Legion","description":"","slug":"legion","color":"#f39c12","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":2,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-02-12T15:47:42+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":2},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"56"}}}},{"type":"tags","id":"20","attributes":{"name":"Battle for Azeroth","description":"","slug":"battle-for-azeroth","color":"#f39c12","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":2,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-02-12T15:47:42+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":2},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"56"}}}},{"type":"tags","id":"21","attributes":{"name":"Shadowlands","description":"","slug":"shadowlands","color":"#f39c12","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":3,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-02-12T15:47:42+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":3},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"56"}}}},{"type":"tags","id":"23","attributes":{"name":"TrinityCore","description":"","slug":"trinitycore","color":"#9b59b6","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":26,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-02-18T21:04:05+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":25},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"57"}}}},{"type":"tags","id":"24","attributes":{"name":"MaNGOS","description":"","slug":"mangos","color":"#9b59b6","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":10,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-02-12T15:47:42+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":12},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"56"}}}},{"type":"tags","id":"25","attributes":{"name":"AzerothCore","description":"","slug":"azerothcore","color":"#9b59b6","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":19,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-02-12T15:47:42+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":17},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"56"}}}},{"type":"tags","id":"26","attributes":{"name":"Skyfire","description":"","slug":"skyfire","color":"#9b59b6","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":3,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-01-05T13:08:13+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":2},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"30"}}}},{"type":"tags","id":"27","attributes":{"name":"Oregoncore","description":"","slug":"oregoncore","color":"#9b59b6","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":7,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-01-07T13:34:50+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":10},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"31"}}}},{"type":"tags","id":"28","attributes":{"name":"C++","description":"","slug":"cplusplus","color":"#2e86c1","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":2,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-01-09T16:29:34+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":3},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"42"}}}},{"type":"tags","id":"29","attributes":{"name":"SQL","description":"","slug":"sql","color":"#2e86c1","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":9,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-01-09T16:29:34+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":9},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"42"}}}},{"type":"tags","id":"30","attributes":{"name":"Lua","description":"","slug":"lua","color":"#2e86c1","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":15,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-01-18T11:03:06+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":15},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"52"}}}},{"type":"tags","id":"31","attributes":{"name":"PHP","description":"","slug":"php","color":"#2e86c1","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":0,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":null,"canStartDiscussion":false,"canAddToDiscussion":false,"postCount":0}},{"type":"tags","id":"32","attributes":{"name":"C++","description":"","slug":"rel-cpp","color":"#e74c3c","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":2,"position":1,"defaultSort":null,"isChild":true,"isHidden":false,"lastPostedAt":"2021-02-18T21:23:41+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":2},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"72"}},"parent":{"data":{"type":"tags","id":"3"}}}},{"type":"tags","id":"33","attributes":{"name":"Lua","description":"","slug":"rel-lua","color":"#e74c3c","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":18,"position":2,"defaultSort":null,"isChild":true,"isHidden":false,"lastPostedAt":"2021-02-18T21:49:19+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":17},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"85"}},"parent":{"data":{"type":"tags","id":"3"}}}},{"type":"tags","id":"34","attributes":{"name":"SQL","description":"","slug":"rel-sql","color":"#e74c3c","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":8,"position":4,"defaultSort":null,"isChild":true,"isHidden":false,"lastPostedAt":"2021-02-18T21:41:46+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":7},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"78"}},"parent":{"data":{"type":"tags","id":"3"}}}},{"type":"tags","id":"35","attributes":{"name":"GIT","description":"","slug":"git","color":"#2e86c1","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":1,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2020-12-31T12:21:21+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":1},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"8"}}}},{"type":"tags","id":"36","attributes":{"name":"windows","description":"","slug":"windows","color":"#27ae60","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":4,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-02-18T21:04:05+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":7},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"57"}}}},{"type":"tags","id":"37","attributes":{"name":"Linux","description":"","slug":"linux","color":"#27ae60","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":4,"position":null,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-02-18T21:04:05+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":5},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"57"}}}},{"type":"tags","id":"38","attributes":{"name":"Guides","description":"","slug":"guides","color":"#00FFF7","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":3,"position":1,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-02-18T21:27:33+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":7},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"76"}}}},{"type":"tags","id":"39","attributes":{"name":"Autres","description":"","slug":"tuto-autres","color":"#e74c3c","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":2,"position":0,"defaultSort":null,"isChild":true,"isHidden":false,"lastPostedAt":"2021-02-03T20:18:27+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":2},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"55"}},"parent":{"data":{"type":"tags","id":"2"}}}},{"type":"tags","id":"40","attributes":{"name":"Autres","description":"","slug":"rel-autres","color":"#e74c3c","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":5,"position":0,"defaultSort":null,"isChild":true,"isHidden":false,"lastPostedAt":"2021-01-27T08:52:01+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":6},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"53"}},"parent":{"data":{"type":"tags","id":"3"}}}},{"type":"tags","id":"42","attributes":{"name":"Model-changing","description":"","slug":"tuto-model-changing","color":"#e74c3c","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":0,"position":3,"defaultSort":null,"isChild":true,"isHidden":false,"lastPostedAt":null,"canStartDiscussion":false,"canAddToDiscussion":false,"postCount":0},"relationships":{"parent":{"data":{"type":"tags","id":"2"}}}},{"type":"tags","id":"43","attributes":{"name":"Model-Changing","description":"","slug":"rel-model-changing","color":"#e74c3c","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":2,"position":3,"defaultSort":null,"isChild":true,"isHidden":false,"lastPostedAt":"2021-02-18T21:42:19+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":2},"relationships":{"lastPostedDiscussion":{"data":{"type":"discussions","id":"79"}},"parent":{"data":{"type":"tags","id":"3"}}}},{"type":"discussions","id":"88","attributes":{"title":"Changer la faction d\u0027une cr\u00e9ature","slug":"88-changer-la-faction-dune-creature","commentCount":1,"participantCount":1,"createdAt":"2021-02-18T21:50:53+00:00","lastPostedAt":"2021-02-18T21:50:53+00:00","lastPostNumber":1,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"2"}}}},{"type":"discussions","id":"85","attributes":{"title":"[AIO] - Modificateur de Rates EXP","slug":"85-aio-modificateur-de-rates-exp","commentCount":1,"participantCount":1,"createdAt":"2021-02-18T21:49:19+00:00","lastPostedAt":"2021-02-18T21:49:19+00:00","lastPostNumber":1,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"2"}}}},{"type":"discussions","id":"28","attributes":{"title":"Comment extraire les Vmaps sur des donjons modifier ?","slug":"28-comment-extraire-les-vmaps-sur-des-donjons-modifier","commentCount":8,"participantCount":4,"createdAt":"2021-01-03T22:30:02+00:00","lastPostedAt":"2021-01-04T19:13:07+00:00","lastPostNumber":8,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"8"}}}},{"type":"discussions","id":"87","attributes":{"title":"Top 10 Ar\u00e8nes C++","slug":"87-top-10-arenes-c","commentCount":1,"participantCount":1,"createdAt":"2021-02-18T21:50:27+00:00","lastPostedAt":"2021-02-18T21:50:27+00:00","lastPostNumber":1,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"2"}}}},{"type":"discussions","id":"74","attributes":{"title":"Modificateur de Rates d\u0027EXP\u0027","slug":"74-modificateur-de-rates-dexp","commentCount":1,"participantCount":1,"createdAt":"2021-02-18T21:25:53+00:00","lastPostedAt":"2021-02-18T21:25:53+00:00","lastPostNumber":1,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"2"}}}},{"type":"discussions","id":"31","attributes":{"title":"LIC - Lua Icons Chat","slug":"31-lic-lua-icons-chat","commentCount":1,"participantCount":1,"createdAt":"2021-01-07T13:34:50+00:00","lastPostedAt":"2021-01-07T13:34:50+00:00","lastPostNumber":1,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"2"}}}},{"type":"discussions","id":"56","attributes":{"title":"WoW Admin Panel Prenium","slug":"56-wow-admin-panel-prenium","commentCount":1,"participantCount":1,"createdAt":"2021-02-12T15:47:42+00:00","lastPostedAt":"2021-02-12T15:47:42+00:00","lastPostNumber":1,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"19"}}}},{"type":"discussions","id":"57","attributes":{"title":"Anti_Farm","slug":"57-anti-farm","commentCount":2,"participantCount":2,"createdAt":"2021-02-18T21:04:05+00:00","lastPostedAt":"2021-02-18T21:08:49+00:00","lastPostNumber":4,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"13"}}}},{"type":"discussions","id":"30","attributes":{"title":"Modifier la distance de vue","slug":"30-modifier-la-distance-de-vue","commentCount":1,"participantCount":1,"createdAt":"2021-01-05T13:08:13+00:00","lastPostedAt":"2021-01-05T13:08:13+00:00","lastPostNumber":1,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"2"}}}},{"type":"discussions","id":"42","attributes":{"title":"Les Bitmasks - Fonctionnement et Exemples","slug":"42-les-bitmasks-fonctionnement-et-exemples","commentCount":2,"participantCount":2,"createdAt":"2021-01-09T16:29:34+00:00","lastPostedAt":"2021-02-12T20:57:11+00:00","lastPostNumber":2,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"13"}}}},{"type":"discussions","id":"52","attributes":{"title":"Texture Coords Calculator","slug":"52-texture-coords-calculator","commentCount":1,"participantCount":1,"createdAt":"2021-01-18T11:03:06+00:00","lastPostedAt":"2021-01-18T11:03:06+00:00","lastPostNumber":1,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"2"}}}},{"type":"discussions","id":"72","attributes":{"title":"NPC Respawn","slug":"72-npc-respawn","commentCount":1,"participantCount":1,"createdAt":"2021-02-18T21:23:41+00:00","lastPostedAt":"2021-02-18T21:23:41+00:00","lastPostNumber":1,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"2"}}}},{"type":"discussions","id":"78","attributes":{"title":"A.R.A.C","slug":"78-arac","commentCount":1,"participantCount":1,"createdAt":"2021-02-18T21:41:46+00:00","lastPostedAt":"2021-02-18T21:41:46+00:00","lastPostNumber":1,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"2"}}}},{"type":"discussions","id":"8","attributes":{"title":"Cloner une version particuli\u00e8re de TrinityCore","slug":"8-cloner-une-version-particuliere-de-trinitycore","commentCount":1,"participantCount":1,"createdAt":"2020-12-31T12:21:21+00:00","lastPostedAt":"2020-12-31T12:21:21+00:00","lastPostNumber":1,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"1"}}}},{"type":"discussions","id":"76","attributes":{"title":"Un serveur, fonctionnement g\u00e9n\u00e9ral","slug":"76-un-serveur-fonctionnement-general","commentCount":1,"participantCount":1,"createdAt":"2021-02-18T21:27:33+00:00","lastPostedAt":"2021-02-18T21:27:33+00:00","lastPostNumber":1,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"2"}}}},{"type":"discussions","id":"55","attributes":{"title":"Cr\u00e9er une nouvelle Map","slug":"55-creer-une-nouvelle-map","commentCount":1,"participantCount":1,"createdAt":"2021-02-03T20:18:27+00:00","lastPostedAt":"2021-02-03T20:18:27+00:00","lastPostNumber":1,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"18"}}}},{"type":"discussions","id":"53","attributes":{"title":"WoW Client Manager","slug":"53-wow-client-manager","commentCount":3,"participantCount":2,"createdAt":"2021-01-20T20:08:53+00:00","lastPostedAt":"2021-01-27T16:51:32+00:00","lastPostNumber":3,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"1"}}}},{"type":"discussions","id":"79","attributes":{"title":"Cr\u00e9er un effet d\u0027enchantement","slug":"79-creer-un-effet-denchantement","commentCount":1,"participantCount":1,"createdAt":"2021-02-18T21:42:19+00:00","lastPostedAt":"2021-02-18T21:42:19+00:00","lastPostNumber":1,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"lastPostedUser":{"data":{"type":"users","id":"2"}}}},{"type":"users","id":"2","attributes":{"username":"iThorgrim","displayName":"iThorgrim","avatarUrl":"https:\/\/forum.open-wow.eu\/assets\/avatars\/m2uNfA3ykacYo3KQ.png","slug":"iThorgrim","joinTime":null}},{"type":"users","id":"8","attributes":{"username":"Shard","displayName":"Shard","avatarUrl":"https:\/\/forum.open-wow.eu\/assets\/avatars\/bYoQgxVXNpTYgA1Z.png","slug":"Shard","joinTime":null}},{"type":"users","id":"19","attributes":{"username":"Torvahal","displayName":"Torvahal","avatarUrl":"https:\/\/forum.open-wow.eu\/assets\/avatars\/Zj382QMdGN5T05KR.png","slug":"Torvahal","joinTime":null}},{"type":"users","id":"13","attributes":{"username":"noc","displayName":"noc","avatarUrl":null,"slug":"noc","joinTime":null}},{"type":"users","id":"1","attributes":{"username":"Galathil","displayName":"Galathil","avatarUrl":"https:\/\/forum.open-wow.eu\/assets\/avatars\/6zjneQm6RzYl44hc.png","slug":"Galathil","joinTime":null}},{"type":"users","id":"18","attributes":{"username":"Nehyren","displayName":"Nehyren","avatarUrl":"https:\/\/forum.open-wow.eu\/assets\/avatars\/JTiwGMIn9vWbQRVE.png","slug":"Nehyren","joinTime":null}}],"session":{"userId":0,"csrfToken":"qe3b4NpeAGCKhgjRTPsUaREKZsW3vHH0vRawFh6K"},"locales":{"fr":"Fran\u00e7ais","en":"English"},"locale":"fr","fof-recaptcha.credentials.site":"6LfKZhoaAAAAALSGOmOPpIVRVM8XRksALQXeFtYW","fof-recaptcha.type":"","apiDocument":{"data":{"type":"discussions","id":"36","attributes":{"title":"D\u00e9veloppement d\u0027un boss : Argaloth","slug":"36-developpement-dun-boss-argaloth","commentCount":1,"participantCount":1,"createdAt":"2021-01-09T12:18:32+00:00","lastPostedAt":"2021-01-09T12:18:32+00:00","lastPostNumber":1,"canReply":false,"canRename":false,"canDelete":false,"canHide":false,"isApproved":true,"isLocked":false,"canLock":false,"isSticky":false,"canSticky":false,"subscription":null,"canTag":false},"relationships":{"posts":{"data":[{"type":"posts","id":"61"}]},"tags":{"data":[{"type":"tags","id":"2"},{"type":"tags","id":"10"}]}}},"included":[{"type":"posts","id":"61","attributes":{"number":1,"createdAt":"2021-01-09T12:18:32+00:00","contentType":"comment","contentHtml":"\u003Cp\u003E\u003Cstrong\u003EImportant :\u003C\/strong\u003E Ce tutoriel a \u00e9t\u00e9 r\u00e9dig\u00e9 par Nobodie pour le site wow-emu.fr. Je le recopie ici \u00e0 l\u0027identique, Il se peut que certaines informations soient obsol\u00e8tes \u00e0 ce jour. Bonne lecture !\u003C\/p\u003E\n\n\u003Ch1\u003ED\u00e9veloppement d\u0027un boss : Argaloth\u003C\/h1\u003E\n\u003Cp\u003EBonjour,\u003C\/p\u003E\n\n\u003Cp\u003Eaujourd\u0027hui nous allons voir ensemble, en pratique, comment scripter un boss. Pour notre exemple, nous allons choisir un boss dont le script est simple : Argaloth. Il s\u0027agit du premier boss du Bastion de Baradin, premier donjon de l\u0027extension Cataclysm. De plus, celui-ci a d\u00e9j\u00e0 \u00e9t\u00e9 cod\u00e9 quasiment parfaitement par Trinity et nous pouvons donc nous en servir comme base d\u0027apprentissage. Entrons d\u00e8s \u00e0 pr\u00e9sent dans le vif du sujet.\u003C\/p\u003E\n\n\u003Cp\u003ELe code complet de Trinity (attention, quelques modifications sont apport\u00e9es par mes soins dans ce tutoriel) est visible \u00e0 \u003Ca href=\u0022https:\/\/github.com\/TrinityCore\/TrinityCore\/blob\/master\/src\/server\/scripts\/EasternKingdoms\/BaradinHold\/boss_pit_lord_argaloth.cpp\u0022 rel=\u0022 nofollow ugc\u0022\u003Ecette adresse\u003C\/a\u003E.\u003C\/p\u003E\n\n\u003Ch2\u003E1) La recherche d\u0027informations\u003C\/h2\u003E\n\n\u003Cp\u003ELe d\u00e9veloppement de boss ressemble \u00e0 ce qu\u0027on appelle de la programmation \u00e9v\u00e9nementielle. On d\u00e9finit un certain nombre d\u0027\u00e9v\u00e9nements qui s\u0027ex\u00e9cutent, et \u00e0 chacun de ces \u00e9v\u00e9nements on associe une fonction qui contient le code charg\u00e9e de g\u00e9rer l\u0027\u00e9v\u00e9nement. La priorit\u00e9, lorsque l\u0027on souhaite d\u00e9velopper un boss, c\u0027est donc de trouver le maximum d\u0027informations \u00e0 son sujet.\u003C\/p\u003E\n\n\u003Cp\u003EPour ce faire, de nombreux sites sont \u00e0 votre disposition, tels que wowhead, judgehype ou m\u00eame youtube pour visualiser des vid\u00e9os du combat sur officiel. Pour ma part, j\u0027utilise principalement wowhead et youtube.\u003C\/p\u003E\n\n\u003Cp\u003EPour ce qui est de wowhead, n\u0027h\u00e9sitez pas \u00e0 regarder les pages dans plusieurs langues. Si on compare la version \u003Ca href=\u0022https:\/\/fr.wowhead.com\/npc=47120\/argaloth\u0022 rel=\u0022 nofollow ugc\u0022\u003EArgaloth\u003C\/a\u003E et \u003Ca href=\u0022https:\/\/www.wowhead.com\/npc=47120\/argaloth\u0022 rel=\u0022 nofollow ugc\u0022\u003EArgaloth\u003C\/a\u003E d\u0027argaloth, on constate que la version fran\u00e7aise est beaucoup plus riche et contient une description de l\u0027ensemble de la strat\u00e9gie \u00e0 appliquer contre ce boss. C\u0027est donc la page fran\u00e7aise qui va nous servir de r\u00e9f\u00e9rence.\u003C\/p\u003E\n\n\u003Cp\u003EApr\u00e8s lecture de ces paragraphes et visualisation de vid\u00e9os sur Youtube, on parvient \u00e0 en extraire 4 \u00e9v\u00e9nements majeurs :\u003C\/p\u003E\n\n \u003Cul\u003E\u003Cli\u003ELancement de \u003Ca href=\u0022https:\/\/fr.wowhead.com\/spell=88942\/attaque-m%C3%A9t%C3%A9orique\u0022 rel=\u0022 nofollow ugc\u0022\u003EAttaque m\u00e9t\u00e9orique\u003C\/a\u003E environ 15 secondes apr\u00e8s le d\u00e9but du combat, puis toutes les 15 \u00e0 20 secondes.\u003C\/li\u003E\n \u003Cli\u003ELancement de \u003Ca href=\u0022https:\/\/fr.wowhead.com\/spell=88954\/t%C3%A9n%C3%A8bres-consumantes\u0022 rel=\u0022 nofollow ugc\u0022\u003ET\u00e9n\u00e8bres consumantes\u003C\/a\u003E environ 20 secondes apr\u00e8s le d\u00e9but du combat, puis toutes les 20 \u00e0 25 secondes.\u003C\/li\u003E\n \u003Cli\u003ELancement de \u003Ca href=\u0022https:\/\/fr.wowhead.com\/spell=88972\/temp%C3%AAte-de-feu-gangren%C3%A9e\u0022 rel=\u0022 nofollow ugc\u0022\u003ETemp\u00eate de feu gangren\u00e9e\u003C\/a\u003E lorsque la vie du boss atteint 66% puis 33% de vie.\u003C\/li\u003E\n \u003Cli\u003ELancement de \u003Ca href=\u0022https:\/\/fr.wowhead.com\/spell=47008\/berserk\u0022 rel=\u0022 nofollow ugc\u0022\u003EBerserk\u003C\/a\u003E au bout de 5 minutes de combat.\u003C\/li\u003E\u003C\/ul\u003E\n\n\u003Cp\u003ENous avons identifi\u00e9 tous nos \u00e9v\u00e9nements, il est temps de cr\u00e9er le fichier cpp qui va contenir le script du boss !\u003C\/p\u003E\n\n\u003Ch2\u003E2) Ou cr\u00e9er un script pour le boss et comment le compiler\u003C\/h2\u003E\n\n\n\u003Cp\u003EL\u0027ensemble des fichiers script du serveur se situent dans le sous-dossier script situ\u00e9 dans l\u0027arborescence suivante : \u003Ccode\u003Esrc\/server\/scripts\/\u003C\/code\u003E.\u003C\/p\u003E\n\n\u003Cp\u003ELes scripts sont majoritairement rang\u00e9s dans des sous-dossiers de la forme \u003Ccode\u003EContinent\/InstanceName\/bossName.cpp\u003C\/code\u003E. N\u0027h\u00e9sitez pas \u00e0 garder cette habitude pour maintenir un dossier de scripts propre.\u003C\/p\u003E\n\n\u003Cp\u003ELes dossiers sont bien constitu\u00e9s et vous trouverez donc (ou cr\u00e9erez) le fichier sous le dossier \u003Ccode\u003EEasternKingdoms\/BaradinHold\u003C\/code\u003E et aura pour nom \u003Ccode\u003Eboss_pit_lord_argaloth.cpp\u003C\/code\u003E. On aurait \u00e9galement pu l\u0027appeler boss_argaloth, \u00e9videmment, mais puisque Trinity l\u0027a appel\u00e9 comme \u00e7a, autant le garder sous la m\u00eame forme \ud83d\ude09\u003C\/p\u003E\n\n\u003Cp\u003ELa chose suivante \u00e0 effectuer est d\u0027integrer ce nouveau fichier aux fichiers de configuration que l\u0027on appelle les fichiers \u003Ccode\u003ECMakeLists.txt\u003C\/code\u003E. Pour cela, ouvrez le fichier dans l\u0027arborescence suivante : \u003Ccode\u003Esrc\/server\/scripts\/EasternKingdoms\/CMakeLists.txt\u003C\/code\u003E et ajoutez (si elle n\u0027existe pas encore) la ligne suivante :\u003C\/p\u003E\n\u003Cpre\u003E\u003Ccode\u003EEasternKingdoms\/BaradinHold\/boss_pit_lord_argaloth.cpp\u003C\/code\u003E\u003Cscript async=\u0022\u0022 crossorigin=\u0022anonymous\u0022 data-hljs-style=\u0022github-gist\u0022 integrity=\u0022sha384-eud4nQrKZMwcYak7or3J5ZPJx1x4HRe8iTTHJy1SUVrDD+fP30Bo\/F8OSdQJpk8d\u0022 onload=\u0022hljsLoader.highlightBlocks(this.parentNode)\u0022 src=\u0022https:\/\/cdn.jsdelivr.net\/gh\/s9e\/hljs-loader@1.0.18\/loader.min.js\u0022\u003E\u003C\/script\u003E\u003C\/pre\u003E\n\n\u003Cp\u003EEn faisant cela, votre fichier sera d\u00e9sormais integr\u00e9 \u00e0 votre projet et sera compil\u00e9 avec vos autres fichiers.\u003C\/p\u003E\n\n\u003Cp\u003EMaintenant que le fichier est cr\u00e9\u00e9, il va nous falloir le remplir avec une classe qui va nous permettre de scripter le boss. Voici le code g\u00e9n\u00e9ral que nous allons y int\u00e9grer :\u003C\/p\u003E\n\n\u003Cpre\u003E\u003Ccode class=\u0022language-cpp\u0022\u003E#include \u0022ScriptMgr.h\u0022\n#include \u0022ScriptedCreature.h\u0022\n\nclass boss_pit_lord_argaloth : public CreatureScript\n{\npublic:\nboss_pit_lord_argaloth() : CreatureScript(\u0022boss_pit_lord_argaloth\u0022) { }\n\nstruct boss_pit_lord_argalothAI : public ScriptedAI\n{\nboss_pit_lord_argalothAI(Creature* creature) : ScriptedAI(creature) { }\n\n};\n\nCreatureAI* GetAI(Creature* creature) const override\n{\nreturn GetBaradinHoldAI\u0026lt;boss_pit_lord_argalothAI\u0026gt;(creature);\n}\n};\n\nvoid AddSC_boss_pit_lord_argaloth()\n{\nnew boss_pit_lord_argaloth();\n}\u003C\/code\u003E\u003Cscript async=\u0022\u0022 crossorigin=\u0022anonymous\u0022 data-hljs-style=\u0022github-gist\u0022 integrity=\u0022sha384-eud4nQrKZMwcYak7or3J5ZPJx1x4HRe8iTTHJy1SUVrDD+fP30Bo\/F8OSdQJpk8d\u0022 onload=\u0022hljsLoader.highlightBlocks(this.parentNode)\u0022 src=\u0022https:\/\/cdn.jsdelivr.net\/gh\/s9e\/hljs-loader@1.0.18\/loader.min.js\u0022\u003E\u003C\/script\u003E\u003C\/pre\u003E\n\n\u003Cp\u003Ece script minimal contient 3 choses primordiales :\u003C\/p\u003E\n \u003Cul\u003E\u003Cli\u003EPremi\u00e8rement, la classe \u003Cstrong\u003Eboss_pit_lord_argaloth\u003C\/strong\u003E h\u00e9rite de CreatureScript (d\u00e9finie dans \u003Ccode\u003Esrc\/server\/game\/Scripting\/ScriptMgr.h)\u003C\/code\u003E. La d\u00e9finition du constructeur de la classe est importante car il appelle le constructeur de CreatureScript qui prend en param\u00e8tre une cha\u00eene de caract\u00e8re (ici \u0022\u003Cstrong\u003Eboss_pit_lord_argaloth\u003C\/strong\u003E\u0022 qui sera utilis\u00e9 plus tard dans la base de donn\u00e9es pour relier le creature_template d\u0027argaloth \u00e0 ce script). C\u0027est donc cette ligne qui vous permet de d\u00e9finir le \u0022nom\u0022 du script.\u003C\/li\u003E\n\u003Cli\u003EDeuxi\u00e8mement, cette classe poss\u00e8de une structure \u003Cstrong\u003Eboss_pit_lord_argalothAI\u003C\/strong\u003E qui h\u00e9rite de ScriptedAI (AI signifiant \u003Cstrong\u003EA\u003C\/strong\u003Ertificial \u003Cstrong\u003EI\u003C\/strong\u003Entelligency). C\u0027est dans cette structure que nous coderons la totalit\u00e9 de notre boss par la suite (attention donc \u00e0 bien \u00e9crire le code futur \u00e0 l\u0027int\u00e9rieur des accolades de cette structure). Il y a \u00e9galement une fonction GetAI qui est une fonction surcharg\u00e9e (comme on le voit avec la constante override \u00e0 la fin de son prototype) qui sert \u00e0 relier l\u0027Intelligence Artificielle (d\u00e9finie dans la structure) \u00e0 notre classe \u003Cstrong\u003Eboss_pit_lord_argaloth\u003C\/strong\u003E. Il est important de garder un prototype identique \u00e0 celui pr\u00e9sent\u00e9 ici, sinon l\u0027appel \u00e0 la fonction ne se fera pas et votre cr\u00e9ature ne fera absolument rien.\u003C\/li\u003E\n \u003Cli\u003EEnfin, il y a une ultime fonction d\u00e9finie tout en bas du script qui va permettre de relier notre CreatureScript aux fonctions de chargement des scripts (que nous allons voir juste apr\u00e8s). Par convention, toutes ces fonctions commencent par le pr\u00e9fixe AddSC (pour Add Script, en anglais) et cr\u00e9\u00e9ent (via l\u0027op\u00e9rateur new une nouvelle occurence de notre script \u003Cstrong\u003Eboss_pit_lord_argaloth\u003C\/strong\u003E.\u003C\/li\u003E\u003C\/ul\u003E\n\n\u003Cp\u003ECertains auront peut-\u00eatre remarqu\u00e9 que notre structure boss_pit_lord_argalothAI h\u00e9rite de ScriptedAI tandis que le script officiel de Trinity h\u00e9rite de BossAI. Pour des raisons de simplification de ce tutoriel, j\u0027ai choisi de ne pas utiliser BossAI car elle n\u00e9cessite un script d\u0027instance qui ne rentre pas dans le cadre de ce tutoriel. N\u00e9anmoins, sachez simplement qu\u0027un script d\u0027instance permet de sauvegarder l\u0027\u00e9tat de l\u0027instance (boss tu\u00e9s, principalement) afin de pouvoir interagir avec elle et effectuer des modifications sur l\u0027instance (par exemple g\u00e9rer l\u0027ouverture de portes menant \u00e0 la suite de l\u0027instance).\u003C\/p\u003E\n\n\u003Cp\u003ESi vous avez eu du mal \u00e0 comprendre certains des termes utilis\u00e9s juste au dessus (h\u00e9ritage, surcharge, constructeur ...) je vous invite grandement \u00e0 stopper la lecture de ce tutoriel et \u00e0 \u003Cdel\u003Epartir \u00e9lever des ch\u00e8vres en Ari\u00e8ge\u003C\/del\u003E (re)lire un cours sur la programmation orient\u00e9e objet avec C++ \u003Ca href=\u0022https:\/\/openclassrooms.com\/fr\/courses\/1894236-programmez-avec-le-langage-c\u0022 rel=\u0022 nofollow ugc\u0022\u003EICI\u003C\/a\u003E !. Vous ne pourrez pas suivre le reste du tutorial sans cela.\u003C\/p\u003E\n\n\u003Cp\u003ESi vous compilez votre projet dans l\u0027\u00e9tat actuel des choses, votre script ne fera rien car non seulement il ne poss\u00e8de encore aucun code sp\u00e9cifique au boss, mais aussi et surtout parce que aucune syst\u00e8me interne au core n\u0027appelle la fonction AddSC_boss_pit_lord_argaloth() que nous avons d\u00e9fini juste avant. Pour ce faire, nous allons ouvrir le fichier suivant dans l\u0027arborescence \u003Ccode\u003Esrc\/server\/game\/Scripting\/ScriptLoader.cpp\u003C\/code\u003E et ajoutez deux lignes qui feront le lien avec notre script :\u003C\/p\u003E\n\n\u003Cp\u003EPremi\u00e8rement la d\u00e9finition de notre fonction :\u003C\/p\u003E\n\u003Cpre\u003E\u003Ccode class=\u0022language-cpp\u0022\u003Evoid AddSC_boss_pit_lord_argaloth();\u003C\/code\u003E\u003Cscript async=\u0022\u0022 crossorigin=\u0022anonymous\u0022 data-hljs-style=\u0022github-gist\u0022 integrity=\u0022sha384-eud4nQrKZMwcYak7or3J5ZPJx1x4HRe8iTTHJy1SUVrDD+fP30Bo\/F8OSdQJpk8d\u0022 onload=\u0022hljsLoader.highlightBlocks(this.parentNode)\u0022 src=\u0022https:\/\/cdn.jsdelivr.net\/gh\/s9e\/hljs-loader@1.0.18\/loader.min.js\u0022\u003E\u003C\/script\u003E\u003C\/pre\u003E\n\n\u003Cp\u003EPuis l\u0027appel \u00e0 la fonction dans la fonction \u003Cstrong\u003Evoid AddEasternKingdomsScripts():\u003C\/strong\u003E\u003C\/p\u003E\n\u003Cpre\u003E\u003Ccode class=\u0022language-cpp\u0022\u003EAddSC_boss_pit_lord_argaloth();\u003C\/code\u003E\u003Cscript async=\u0022\u0022 crossorigin=\u0022anonymous\u0022 data-hljs-style=\u0022github-gist\u0022 integrity=\u0022sha384-eud4nQrKZMwcYak7or3J5ZPJx1x4HRe8iTTHJy1SUVrDD+fP30Bo\/F8OSdQJpk8d\u0022 onload=\u0022hljsLoader.highlightBlocks(this.parentNode)\u0022 src=\u0022https:\/\/cdn.jsdelivr.net\/gh\/s9e\/hljs-loader@1.0.18\/loader.min.js\u0022\u003E\u003C\/script\u003E\u003C\/pre\u003E\n\n\u003Cp\u003EJe vous laisse prendre exemple sur le fichier pour trouver ou \u00e9crire ces deux lignes \ud83d\ude09\u003C\/p\u003E\n\n\u003Cp\u003EVoil\u00e0 qui est fait, l\u0027ultime \u00e9tape reste \u00e0 modifier la DB pour associer notre creature_template d\u0027Argaloth (entry #47120) au ScriptName d\u00e9fini un peu plus t\u00f4t : \u003Cstrong\u003Eboss_pit_lord_argaloth\u003C\/strong\u003E.\u003C\/p\u003E\n\n\n\u003Cp\u003EUne fois que tout ceci est fait, notre script est pr\u00eat \u00e0 coder !\u003C\/p\u003E\n\n\n\u003Ch2\u003E3) D\u00e9finition des \u00e9num\u00e9rations n\u00e9cessaires \u00e0 notre boss\u003C\/h2\u003E\n\n\u003Cp\u003EPar convention, l\u0027ensemble des scripts sont \u00e9crits en langue anglaise. Aussi je ne saurais que trop vous inviter \u00e0 vous adapter \u00e0 la langue de Shakespeare \ud83d\ude09\u003C\/p\u003E\n\n\u003Cp\u003ENous l\u0027avons dit tout \u00e0 l\u0027heure, il y a en tout 4 spells \u00e0 lancer. Nous allons donc commencer simplement en d\u00e9finissant une \u00e9num\u00e9ration contenant l\u0027ensemble de ces sorts (afin d\u0027avoir un script bien lisible par la suite). En dehors de toute fonction\/classe, il suffit d\u0027\u00e9crire la chose suivante :\u003C\/p\u003E\n\n\u003Cpre\u003E\u003Ccode class=\u0022language-cpp\u0022\u003Eenum Spells\n{\nSPELL_METEOR_SLASH = 88942,\nSPELL_CONSUMING_DARKNESS = 88954,\nSPELL_FEL_FIRESTORM = 88972,\nSPELL_BERSERK = 47008\n};\u003C\/code\u003E\u003Cscript async=\u0022\u0022 crossorigin=\u0022anonymous\u0022 data-hljs-style=\u0022github-gist\u0022 integrity=\u0022sha384-eud4nQrKZMwcYak7or3J5ZPJx1x4HRe8iTTHJy1SUVrDD+fP30Bo\/F8OSdQJpk8d\u0022 onload=\u0022hljsLoader.highlightBlocks(this.parentNode)\u0022 src=\u0022https:\/\/cdn.jsdelivr.net\/gh\/s9e\/hljs-loader@1.0.18\/loader.min.js\u0022\u003E\u003C\/script\u003E\u003C\/pre\u003E\n\n\u003Cp\u003ELes ID des sorts sont disponibles via wowhead.\u003C\/p\u003E\n\n\u003Cp\u003ENous allons \u00e9galement cr\u00e9er une seconde \u00e9num\u00e9ration correspondant \u00e0 nos \u00e9v\u00e9nements. Comme on l\u0027a dit, l\u0027\u00e9v\u00e9nement d\u00e9clenchant l\u0027envoi du sort \u003Ca href=\u0022https:\/\/fr.wowhead.com\/spell=88972\/temp%C3%AAte-de-feu-gangren%C3%A9e\u0022 rel=\u0022 nofollow ugc\u0022\u003ETemp\u00eate de feu gangren\u00e9e\u003C\/a\u003E ne sera pas fait. Il y a donc seulement 3 \u00e9v\u00e9nements \u00e0 d\u00e9finir :\u003C\/p\u003E\n\n\u003Cpre\u003E\u003Ccode class=\u0022language-cpp\u0022\u003Eenum Events\n{\nEVENT_METEOR_SLASH = 1,\nEVENT_CONSUMING_DARKNESS = 2,\nEVENT_BERSERK = 3\n};\u003C\/code\u003E\u003Cscript async=\u0022\u0022 crossorigin=\u0022anonymous\u0022 data-hljs-style=\u0022github-gist\u0022 integrity=\u0022sha384-eud4nQrKZMwcYak7or3J5ZPJx1x4HRe8iTTHJy1SUVrDD+fP30Bo\/F8OSdQJpk8d\u0022 onload=\u0022hljsLoader.highlightBlocks(this.parentNode)\u0022 src=\u0022https:\/\/cdn.jsdelivr.net\/gh\/s9e\/hljs-loader@1.0.18\/loader.min.js\u0022\u003E\u003C\/script\u003E\u003C\/pre\u003E\n\n\u003Cp\u003EAttention, si la valeur num\u00e9rique d\u00e9finissant un \u00e9v\u00e9nement importe peu, il est par contre \u003Cstrong\u003Eprimordial\u003C\/strong\u003E que le premier \u00e9v\u00e9nement d\u00e9fini commence avec l\u0027ID 1 et non 0. Sinon, celui-ci ne sera pas ex\u00e9cut\u00e9 ensuite lorsqu\u0027on arrivera \u00e0 la gestion des \u00e9v\u00e9nements.\u003C\/p\u003E\n\n\u003Cp\u003Evoil\u00e0 qui est tout pour la d\u00e9finition des \u00e9num\u00e9rations n\u00e9cessaires \u00e0 notre boss\u003C\/p\u003E\n\n\u003Ch2\u003E4) Surcharge des fonctions du script\u003C\/h2\u003E\n\n\u003Cp\u003ENous allons reparler ici des fonctions surcharg\u00e9es. En effect, l\u0027ensemble du syst\u00e8me de script repose sur cette notion de la programmation orient\u00e9e objet. L\u0027intelligence artificielle de notre boss h\u00e9rite d\u0027une structure d\u00e9finie par le core. Cette structure poss\u00e8de diff\u00e9rentes fonctions appel\u00e9es \u00e0 des moments cl\u00e9 de l\u0027ex\u00e9cution d\u0027un boss. Par exemple, la fonction \u003Cstrong\u003EEnterCombat\u003C\/strong\u003E est appel\u00e9e lorsque le groupe de joueurs entre en combat avec le boss. la fonction \u003Cstrong\u003EDamageTaken\u003C\/strong\u003E est appel\u00e9e ... chaque fois que le boss prend des d\u00e9gats. Et la fonction \u003Cstrong\u003EUpdateAI\u003C\/strong\u003E est appel\u00e9e \u00e0 chaque tick d\u0027horloge du serveur. Ces trois fonctions nous seront d\u0027ailleurs n\u00e9cessaires pour coder notre boss. Pour rappel, ces fonctions sont \u00e0 d\u00e9finir \u00e0 l\u0027int\u00e9rieur de notre structure h\u00e9rit\u00e9e de ScriptedAI. Ne vous trompez pas !\u003C\/p\u003E\n\n\u003Cp\u003EFaites tr\u00e8s attention au prototype de votre fonction. Si celle-ci ne correspond pas exactement au prototype de la fonction m\u00e8re, c\u0027est la fonction m\u00e8re qui sera appel\u00e9e en lieu et place de la votre, et votre boss ne fera donc que la moiti\u00e9 des actions que vous lui auriez programm\u00e9. Cette erreur est souvent commise par m\u00e9garde et peut ensuite faire l\u0027objet de nombreuses heures de recherches.\u003C\/p\u003E\n\n\u003Ch3\u003Ea) Surcharge de EnterCombat\u003C\/h3\u003E\n\n\u003Cp\u003ENous allons donc commencer par EnterCombat, qui est appel\u00e9 d\u00e8s lors que le combat avec le boss commence. Voici le code de la fonction sur Trinity :\u003C\/p\u003E\n\n\u003Cpre\u003E\u003Ccode class=\u0022language-cpp\u0022\u003Evoid EnterCombat(Unit* \/*who*\/) override\n{\n_EnterCombat();\n\/\/instance-\u0026gt;SendEncounterUnit(ENCOUNTER_FRAME_ENGAGE, me);\nevents.ScheduleEvent(EVENT_METEOR_SLASH, urand(10 * IN_MILLISECONDS, 20 * IN_MILLISECONDS));\nevents.ScheduleEvent(EVENT_CONSUMING_DARKNESS, urand(20 * IN_MILLISECONDS, 25 * IN_MILLISECONDS));\nevents.ScheduleEvent(EVENT_BERSERK, 5 * MINUTE * IN_MILLISECONDS);\n}\u003C\/code\u003E\u003Cscript async=\u0022\u0022 crossorigin=\u0022anonymous\u0022 data-hljs-style=\u0022github-gist\u0022 integrity=\u0022sha384-eud4nQrKZMwcYak7or3J5ZPJx1x4HRe8iTTHJy1SUVrDD+fP30Bo\/F8OSdQJpk8d\u0022 onload=\u0022hljsLoader.highlightBlocks(this.parentNode)\u0022 src=\u0022https:\/\/cdn.jsdelivr.net\/gh\/s9e\/hljs-loader@1.0.18\/loader.min.js\u0022\u003E\u003C\/script\u003E\u003C\/pre\u003E\n\n\u003Cp\u003EOn peut voir qu\u0027elle fait 5 lignes que nous allons d\u00e9velopper juste apr\u00e8s :\u003C\/p\u003E\n \u003Cul\u003E\u003Cli\u003E\u003Cstrong\u003E_EnterCombat();\u003C\/strong\u003E : Il s\u0027agit de l\u0027appel \u00e0 une sous fonction EnterCombat d\u00e9finie dans la classe m\u00e8re. Elle permet de ne pas avoir \u00e0 initialiser un certain nombre de choses dans notre code.\u003C\/li\u003E\n \u003Cli\u003E\u003Cstrong\u003Einstance-\u0026gt;SendEncounterUnit(ENCOUNTER_FRAME_ENGAGE, me)\u003C\/strong\u003E; : Cette ligne (que j\u0027ai volontairement comment\u00e9e) sert \u00e0 interagir avec notre \u00e9ventuel script d\u0027instance afin de pouvoir sauvegarder son \u00e9tat d\u0027avancement.\u003C\/li\u003E\n \u003Cli\u003E\u003Cstrong\u003Eevents.ScheduleEvent(EVENT_METEOR_SLASH, urand(10 * IN_MILLISECONDS, 20 * IN_MILLISECONDS));\u003C\/strong\u003E : Cette ligne nous permet de cr\u00e9er un premier \u00e9v\u00e9nement \u00e0 partir de notre \u00e9num\u00e9ration. On lui attribue un temps d\u0027ex\u00e9cution entre 10 et 20 secondes.\u003C\/li\u003E\n \u003Cli\u003E\u003Cstrong\u003Eevents.ScheduleEvent(EVENT_CONSUMING_DARKNESS, urand(20 * IN_MILLISECONDS, 25 * IN_MILLISECONDS));\u003C\/strong\u003E : Cette ligne nous permet de cr\u00e9er un second \u00e9v\u00e9nement \u00e0 partir de notre \u00e9num\u00e9ration. On lui attribue un temps d\u0027ex\u00e9cution al\u00e9atoire entre 20 et 25 secondes.\u003C\/li\u003E\n \u003Cli\u003E\u003Cstrong\u003Eevents.ScheduleEvent(EVENT_BERSERK, 5 * MINUTE * IN_MILLISECONDS);\u003C\/strong\u003E : Cette ligne nous permet de cr\u00e9er un troisi\u00e8me \u00e9v\u00e9nement \u00e0 partir de notre \u00e9num\u00e9ration. On lui attribue un temps d\u0027ex\u00e9cution de 5 minutes.\u003C\/li\u003E\u003C\/ul\u003E\n\n\u003Cp\u003EIl faut bien saisir que nous ne faison ici qu\u0027enregistrer les trois \u00e9v\u00e9nements. Il seront trait\u00e9s par la suite.\u003C\/p\u003E\n\n\u003Ch3\u003Eb) Surcharge de EnterEvadeMode\u003C\/h3\u003E\n\n\u003Cp\u003EVoici le code source de cette fonction :\u003C\/p\u003E \n\u003Cpre\u003E\u003Ccode class=\u0022language-cpp\u0022\u003Evoid EnterEvadeMode() override\n{\nme-\u0026gt;GetMotionMaster()-\u0026gt;MoveTargetedHome();\n\/\/instance-\u0026gt;SendEncounterUnit(ENCOUNTER_FRAME_DISENGAGE, me);\n_DespawnAtEvade();\n}\u003C\/code\u003E\u003Cscript async=\u0022\u0022 crossorigin=\u0022anonymous\u0022 data-hljs-style=\u0022github-gist\u0022 integrity=\u0022sha384-eud4nQrKZMwcYak7or3J5ZPJx1x4HRe8iTTHJy1SUVrDD+fP30Bo\/F8OSdQJpk8d\u0022 onload=\u0022hljsLoader.highlightBlocks(this.parentNode)\u0022 src=\u0022https:\/\/cdn.jsdelivr.net\/gh\/s9e\/hljs-loader@1.0.18\/loader.min.js\u0022\u003E\u003C\/script\u003E\u003C\/pre\u003E\n\n\u003Cp\u003EIl n\u0027y a pas grand chose \u00e0 expliquer, la premi\u00e8re ligne g\u00e9n\u00e8re un mouvement de la cr\u00e9ature (identifi\u00e9e par le pointeur interne me) vers sa position initiale. La seconde ligne est \u00e0 nouveau comment\u00e9e car inutile dans ce tutoriel, et la troisi\u00e8me fait appel \u00e0 la fonction interne g\u00e9rant le despawn de la cr\u00e9ature.\u003C\/p\u003E\n\n\u003Ch3\u003Ec) Surcharge de JustDied\u003C\/h3\u003E\n\u003Cpre\u003E\u003Ccode class=\u0022language-cpp\u0022\u003Evoid JustDied(Unit* \/*killer*\/) override\n{\n_JustDied();\n\/\/instance-\u0026gt;SendEncounterUnit(ENCOUNTER_FRAME_DISENGAGE, me);\n}\u003C\/code\u003E\u003Cscript async=\u0022\u0022 crossorigin=\u0022anonymous\u0022 data-hljs-style=\u0022github-gist\u0022 integrity=\u0022sha384-eud4nQrKZMwcYak7or3J5ZPJx1x4HRe8iTTHJy1SUVrDD+fP30Bo\/F8OSdQJpk8d\u0022 onload=\u0022hljsLoader.highlightBlocks(this.parentNode)\u0022 src=\u0022https:\/\/cdn.jsdelivr.net\/gh\/s9e\/hljs-loader@1.0.18\/loader.min.js\u0022\u003E\u003C\/script\u003E\u003C\/pre\u003E\n\n\u003Cp\u003ERien de particulier \u00e0 expliquer ici.\u003C\/p\u003E\n\n\u003Ch3\u003Ed) Surcharge de UpdateAI\u003C\/h3\u003E\n\n\u003Cp\u003EIci vient la principale fonction, et la plus int\u00e9ressante, dont voici le code :\u003C\/p\u003E\n\u003Cpre\u003E\u003Ccode class=\u0022language-cpp\u0022\u003Evoid UpdateAI(uint32 diff) override\n{\nif (!UpdateVictim())\nreturn;\n\nevents.Update(diff);\n\nif (me-\u0026gt;HasUnitState(UNIT_STATE_CASTING))\nreturn;\n\nwhile (uint32 eventId = events.ExecuteEvent())\n{\nswitch (eventId)\n{\ncase EVENT_METEOR_SLASH:\nDoCastAOE(SPELL_METEOR_SLASH);\nevents.ScheduleEvent(EVENT_METEOR_SLASH, urand(15 * IN_MILLISECONDS, 20 * IN_MILLISECONDS));\nbreak;\ncase EVENT_CONSUMING_DARKNESS:\nDoCastAOE(SPELL_CONSUMING_DARKNESS, true);\nevents.ScheduleEvent(EVENT_CONSUMING_DARKNESS, urand(20 * IN_MILLISECONDS, 25 * IN_MILLISECONDS));\nbreak;\ncase EVENT_BERSERK:\nDoCast(me, SPELL_BERSERK, true);\nbreak;\ndefault:\nbreak;\n}\n}\n\nDoMeleeAttackIfReady();\n}\u003C\/code\u003E\u003Cscript async=\u0022\u0022 crossorigin=\u0022anonymous\u0022 data-hljs-style=\u0022github-gist\u0022 integrity=\u0022sha384-eud4nQrKZMwcYak7or3J5ZPJx1x4HRe8iTTHJy1SUVrDD+fP30Bo\/F8OSdQJpk8d\u0022 onload=\u0022hljsLoader.highlightBlocks(this.parentNode)\u0022 src=\u0022https:\/\/cdn.jsdelivr.net\/gh\/s9e\/hljs-loader@1.0.18\/loader.min.js\u0022\u003E\u003C\/script\u003E\u003C\/pre\u003E\n\n\u003Cp\u003ECette fonction est divis\u00e9e en plusieurs parties que nous allons voir d\u00e8s \u00e0 pr\u00e9sent :\u003C\/p\u003E\n \u003Cul\u003E\u003Cli\u003EPremi\u00e8rement, on v\u00e9rifie qu\u0027on poss\u00e8de bien une victime potentielle. S\u0027il n\u0027y en a aucune (et que donc tout le monde est mort) il n\u0027y a plus aucune raison de faire s\u0027ex\u00e9cuter le boss. On quitte donc via return.\u003C\/li\u003E\n \u003Cli\u003EEnsuite, on met \u00e0 jour les \u00e9v\u00e9nements via la proc\u00e9dure Update. Celle-ci prend en parama\u00e8tre la variable diff qui est en fait le temps (en millisecondes) depuis le pr\u00e9c\u00e9dent appel \u00e0 UpdateAI. Cella va donc mettre \u00e0 jour les timers de tous les \u00e9v\u00e9nements d\u00e9finis via la fonction EnterCombat vue pr\u00e9c\u00e9demment.\u003C\/li\u003E\n \u003Cli\u003EPuis, si le boss est d\u00e9j\u00e0 en train de lancer un sort, il faut le laisser poursuivre son cast. Nous quittons donc notre boucle.\u003C\/li\u003E\n \u003Cli\u003EEnfin arrive une boucle while qui peut se traduire litt\u00e9ralement par \u0022Tant qu\u0027il reste des \u00e9v\u00e9nements \u00e0 ex\u00e9cuter\u0022. C\u0027est \u00e0 cause de ce while que nos \u00e9v\u00e9nements auparavant d\u00e9finis dans l\u0027\u00e9num\u00e9ration devaient \u00eatre diff\u00e9rents de 0, car sinon cette condition serait consid\u00e9r\u00e9e comme fausse et l\u0027on sortirait alors de la boucle sans jamais entrer dedans. Chacun des \u00e9v\u00e9nements poss\u00e8de alors sont propre code. On peut voir qu\u0027il y a en g\u00e9n\u00e9ral deux lignes :\n    \u003Cul\u003E\u003Cli\u003ELe lancement du spell correspondant (lui aussi indiqu\u00e9 pr\u00e9c\u00e9demment via une \u00e9num\u00e9ration). Ici ce sont des AoE, mais il pourrait y avoir d\u0027autres syst\u00e8mes pour r\u00e9cup\u00e9rer une cible al\u00e9atoire ou le tank du groupe, par exemple.\u003C\/li\u003E\n    \u003Cli\u003EL\u0027appel \u00e0 nouveau au ScheduleEvent qui permet de red\u00e9finir le prochain temps permettant de relancer le sort ensuite.\u003Cbr\u003E\n Dals le cas de Berserk, \u00e9videmment, il n\u0027y a pas de ScheduleEvent du fait que si le groupe ne parvient pas \u00e0 tuer le boss en moins de 5 minutes, celui-ci entre en mode Berserk jusqu\u0027\u00e0 la fin du combat.\u003C\/li\u003E\u003C\/ul\u003E\u003C\/li\u003E\n \u003Cli\u003EFinalement, on appelle la fonction \u003Cstrong\u003EDoMeleeAttackIfReady()\u003C\/strong\u003E qui est en g\u00e9n\u00e9ral la derni\u00e8re appel\u00e9e dans UpdateAI et qui permet au boss de tapper au corps \u00e0 corps si son \u00e9tat le lui permet (c\u0027est-\u00e0-dire s\u0027il n\u0027est pas en train de caster un sort, s\u0027il n\u0027est pas entrav\u00e9, etc).\u003C\/li\u003E\u003C\/ul\u003E\n\n\u003Ch3\u003E5) Pour aller plus loin\u003C\/h3\u003E\n\n\u003Cp\u003EComme nous l\u0027avons vu ensemble, il reste un sort qui n\u0027a pas \u00e9t\u00e9 lanc\u00e9. Il s\u0027agit de \u003Ca href=\u0022http:\/\/fr.wowhead.com\/spell=88972\u0022 rel=\u0022 nofollow ugc\u0022\u003ETemp\u00eate de feu gangren\u00e9e\u003C\/a\u003E. Pour cela, il vous faut surcharger la fonction DamageTaken afin d\u0027envoyer ce sort \u003Cstrong\u003Eexactement\u003C\/strong\u003E lorsque le boss passe sous la barre des 66% puis des 33%.\u003C\/p\u003E\n\n\u003Cp\u003ELe code propos\u00e9 par trinity est faux, la condition est vraie d\u00e8s lors que le boss passe sous la barre des 66% de vie et enverra d\u00e8s lors la temp\u00eate \u00e0 chaque appel \u00e0 DamageTaken. A vous de changer son comportement en integrant par exemple un bool\u00e9en permettant de connaitre l\u0027ancien \u00e9tat du boss.\u003C\/p\u003E\n\n\u003Cp\u003EEnfin, nous avons ici trait\u00e9 l\u0027aspect purement technique du boss, et ne nous sommes donc pas pench\u00e9s sur le script des sorts en eux-m\u00eames. Il est probable que ceux-ci puissent n\u00e9cessiter des modifications afin de correspondre au syst\u00e8me officiel. Nous ne traiterons pas dans ce tutoriel de comment scripter des sorts, mais cela fera peut-\u00eatre l\u0027objet d\u0027un futur tutoriel. Libre \u00e0 vous \u00e9galement de vous renseigner de votre c\u00f4t\u00e9 pour savoir comment faire \ud83d\ude09\u003C\/p\u003E\n\n\u003Ch3\u003E6) Conclusion\u003C\/h3\u003E\n\u003Cp\u003EVoil\u00e0 que se termine ce tutoriel. Apr\u00e8s correction des erreurs de compilation, votre script devrait pouvoir s\u0027ex\u00e9cuter et vous aurez alors devant vous un boss Argaloth pr\u00eat \u00e0 en d\u00e9coudre !\u003C\/p\u003E\n\n\u003Cp\u003EGardez \u00e0 l\u0027esprit que ce boss est parmi les plus simples de Wow et que, l\u00e0 ou ce script fait moins d\u0027une centaine de lignes, d\u0027autres en font pr\u00e8s de 6000 \ud83d\ude00 Pr\u00e9parez-vous donc \u00e0 souffrir, mais n\u0027oubliez pas pour autant que tout est r\u00e9alisable et que seule votre volont\u00e9 vous permettra d\u0027arriver \u00e0 vos fins. Alors n\u0027abandonnez pas \u00e0 la moindre difficult\u00e9 et poursuivez vos efforts !\u003C\/p\u003E\n\n\u003Cp\u003E\u003Cdel\u003EJe reste disponible pour toutes questions\/am\u00e9liorations propos\u00e9es.\u003C\/del\u003E\u003C\/p\u003E","editedAt":"2021-01-09T12:48:30+00:00","canEdit":false,"canDelete":false,"canHide":false,"isApproved":true,"canApprove":false,"canFlag":false,"canLike":false},"relationships":{"discussion":{"data":{"type":"discussions","id":"36"}},"user":{"data":{"type":"users","id":"1"}},"editedUser":{"data":{"type":"users","id":"1"}},"likes":{"data":[]},"mentionedBy":{"data":[]}}},{"type":"users","id":"1","attributes":{"username":"Galathil","displayName":"Galathil","avatarUrl":"https:\/\/forum.open-wow.eu\/assets\/avatars\/6zjneQm6RzYl44hc.png","slug":"Galathil","joinTime":null,"discussionCount":33,"commentCount":35,"canEdit":false,"canDelete":false,"lastSeenAt":"2021-02-17T17:13:27+00:00","canSuspend":false},"relationships":{"groups":{"data":[{"type":"groups","id":"1"},{"type":"groups","id":"4"}]}}},{"type":"groups","id":"1","attributes":{"nameSingular":"Administrateur","namePlural":"Administrateurs","color":"#B72A2A","icon":"fas fa-wrench","isHidden":0}},{"type":"groups","id":"4","attributes":{"nameSingular":"Mod\u00e9rateur","namePlural":"Mod\u00e9rateurs","color":"#80349E","icon":"fas fa-bolt","isHidden":0}},{"type":"tags","id":"2","attributes":{"name":"Tutoriels","description":"","slug":"tutoriels","color":"#e74c3c","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":56,"position":2,"defaultSort":null,"isChild":false,"isHidden":false,"lastPostedAt":"2021-02-18T21:50:53+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":52}},{"type":"tags","id":"10","attributes":{"name":"C++","description":"","slug":"tuto-cpp","color":"#e74c3c","backgroundUrl":null,"backgroundMode":null,"icon":"","discussionCount":11,"position":1,"defaultSort":null,"isChild":true,"isHidden":false,"lastPostedAt":"2021-02-18T21:50:27+00:00","canStartDiscussion":false,"canAddToDiscussion":false,"postCount":9}}]}});
                flarum.core.app.bootExtensions(flarum.extensions);
                flarum.core.app.boot();
            } catch (e) {
                var error = document.getElementById('flarum-loading-error');
                error.innerHTML += document.getElementById('flarum-content').textContent;
                error.style.display = 'block';
                throw e;
            }
        </script>
</body>
</html>
